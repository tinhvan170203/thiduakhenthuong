import{d as ae,r as a,u as se,e as le,j as e,f as ne}from"./index-371a4e8f.js";import{S as u}from"./react-select.esm-68469137.js";import{u as oe}from"./index.esm-dbde89ce.js";import{c as ie}from"./canboApi-98c0e799.js";import{t as ce}from"./thongkeApi-1c610a45.js";import{d as re}from"./BarChart-5733c919.js";import{S as de}from"./SettingSendUser-d5b98a8c.js";import{R as h}from"./RectangleChart-512fbbbc.js";import{D as me}from"./DoughnutChart-114a4d04.js";import{T as he}from"./TableChitietThiduanamTonghop-8ea69dd6.js";import{C as ue,d as xe}from"./FileDownload-e634af8f.js";import{B}from"./Button-c29e04f7.js";import"./memoize-one.esm-8b357e52.js";import"./ButtonBase-3ca56fd5.js";import"./createSvgIcon-b5eb2c40.js";import"./index.esm-a80e06b2.js";import"./index-0fc6c329.js";import"./index-386ef5dd.js";import"./LastPage-410e0def.js";import"./MenuItem-0a823130.js";import"./dayjs.min-9420a05b.js";import"./Link-24b18a5a.js";let pe=[{label:"STT",key:"stt"},{label:"Họ tên",key:"hoten"},{label:"Đơn vị đang công tác",key:"donvidangcongtac"},{label:"Kết quả xếp loại thi đua năm",key:"xeploai"}];const Oe=()=>{const X=ae(t=>t.authReducer.vaitro_theodoithidua);a.useState([]);const[Y,x]=a.useState([]),[o,T]=a.useState({label:2025,value:2025}),[i,p]=a.useState({label:2025,value:2025}),[r,C]=a.useState(""),[q,A]=a.useState(!1),[k,K]=a.useState([]),[L,O]=a.useState([]),P=se(),[ve,_]=le(),[ge,R]=a.useState(0),[fe,F]=a.useState(""),[D,G]=a.useState([]),[M,U]=a.useState([]),[v,w]=a.useState({label:"",value:""});a.useState([]);const[g,H]=a.useState(""),[V,z]=a.useState([]),[$,f]=a.useState([]),[b,Q]=a.useState(0),[j,I]=a.useState(0),[N,J]=a.useState(0),[y,W]=a.useState(0),[S,Z]=a.useState(0),[d,E]=a.useState({label:"Chưa chọn xếp loại tính theo số lượt tối tiểu",value:""});oe({defaultValues:{donvi:{label:"Tất cả",value:""},nam:"",denngay:"",hoten:""}}),a.useEffect(()=>{(async()=>{try{let s=await ie.fetchYearMonth(),n=await ne.getUserOfKhoi({vaitro:X});O(n.data),T({label:s.data.year-1,value:s.data.year-1}),p({label:s.data.year,value:s.data.year}),R(s.data.year),F(s.data.year);let l=[];for(let c=s.data.year;c>=2022;c--)l.push({label:c,value:c});G(l)}catch(s){s.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(P("/login"),toast.error(s.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(s.message)}})()},[]);const ee=async t=>{let s=[...t];K(s.map(n=>n.value)),A(!1)},te=async()=>{if(k.length===0){alert("Vui lòng chọn đơn vị cần thống kê kết quả");return}_(!0);try{let t=await ce.getXeploaidangvienCacNam({tunam:o,dennam:i,donvis:k});z(t.data.data),f(t.data.data),U([{label:"Tất cả",value:""}].concat(t.data.list_doi_option)),I(t.data.total_khtnv),J(t.data.total_htnv),W(t.data.total_httnv),Z(t.data.total_htxsnv),Q(t.data.total_not_value),H(""),w({label:"Tất cả",value:""}),E({label:"Chưa chọn xếp loại tính theo số lượt tối tiểu",value:""}),x(t.data.data.map((s,n)=>({stt:n+1,hoten:s.hoten,donvidangcongtac:s.donvidangcongtac,xeploai:s.result.map(l=>`${l.nam}: ${l.result}`),ghichu:s.ghichu}))),_(!1)}catch(t){console.log(t)}};return a.useEffect(()=>{i.value<o.value&&(alert("Giá trị đến năm phải lớn hơn hoặc bằng giá trị từ năm"),p({label:o.label,value:o.value}))},[i,o]),a.useEffect(()=>{let t=[...V];if(t.length>0){const s=setTimeout(()=>{let n=t.filter(l=>l.hoten.toLowerCase().includes(g.toLowerCase())&&l.id_donvidangcongtac.includes(v.value));f(n),x(n.map((l,c)=>({stt:c+1,hoten:l.hoten,donvidangcongtac:l.donvidangcongtac,xeploai:l.result.map(m=>`${m.nam}: ${m.result}`)})))},500);return()=>clearTimeout(s)}},[g,v]),a.useEffect(()=>{let t=[...V];if(r<0){alert("Vui lòng chọn giá trị số lượt tối thiểu lớn hơn 0"),C("");return}if(d.value!==""&&t.length>0){const s=setTimeout(()=>{let n=t.filter(l=>l[d.value]>=r);f(n),x(n.map((l,c)=>({stt:c+1,hoten:l.hoten,donvidangcongtac:l.donvidangcongtac,xeploai:l.result.map(m=>`${m.nam}: ${m.result}`)})))},400);return()=>clearTimeout(s)}},[r,d]),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Thống kê, theo dõi kết quả xếp loại đảng viên của đảng viên trong khoảng thời gian năm"})}),e.jsxs("div",{className:"shadow-gray-400  shadow-md p-4 rounded-sm",children:[e.jsxs("div",{className:"my-2 mt-4 flex justify-center flex-wrap",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Từ năm: "}),e.jsx(u,{options:D,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"",onChange:t=>T(t),value:o})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Đến năm: "}),e.jsx(u,{options:D,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"",onChange:t=>p(t),value:i})]}),e.jsx("div",{className:"flex-col px-1 flex items-end justify-center",children:e.jsxs(B,{variant:"contained",onClick:()=>te(),style:{width:"200px"},color:"primary",children:[e.jsx(re,{})," Thống kê dữ liệu"]})})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex px-1",children:[e.jsx("label",{className:"font-semibold",children:"Đơn vị: "}),e.jsx(de,{onSubmit:ee,list:L,resetCheckbox:q})]})]}),e.jsx("p",{className:"text-red-600 font-medium text-center mt-8",children:`Biểu đồ kết quả xếp loại đảng viên từ năm ${o.value} đến năm ${i.value}`}),e.jsx("div",{className:"flex mb-8 mt-2 justify-center items-center shadow-lg shadow-slate-300 py-8",children:e.jsx("div",{className:"md:basis-1/4",children:e.jsx(me,{text:`Biểu đồ kết quả đảng viên của đảng viên từ năm ${o.value} đến năm ${i.value}`,dataHTNV:N,dataHTTNV:y,dataHTXSNV:S,dataKHTNV:j,dataNotValue:b,total:N+y+S+j+b})})}),e.jsxs("div",{className:"shadow-lg  mb-8 pb-8 shadow-slate-300 ",children:[e.jsxs("div",{className:"flex mt-4",children:[e.jsx(h,{text:"Hoàn thành xuất sắc nhiệm vụ",number:S,color:"bg-red-600"}),e.jsx(h,{text:"Hoàn thành tốt nhiệm vụ",number:y,color:"bg-cyan-600"}),e.jsx(h,{text:"Hoàn thành nhiệm vụ",number:N,color:"bg-blue-600"}),e.jsx(h,{text:"Không hoàn thành nhiệm vụ",number:j,color:"bg-pink-600"}),e.jsx(h,{text:"Chưa có dữ liệu",number:b,color:"bg-yellow-600"})]}),e.jsx("p",{className:"text-blue-600 font-medium text-center mt-2",children:"Thống kê số lượt xếp loại đảng viên"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-center text-lg mt-8 font-semibold",children:"Danh sách xếp loại đảng viên của đảng viên"}),e.jsxs("h3",{className:"text-center italic",children:["(từ năm ",o.value," đến năm ",i.value,")"]}),e.jsxs("h3",{className:"text-end my-4",children:["Tổng số: ",e.jsx("span",{className:"text-xl font-bold text-red-600",children:$.length})," đảng viên"]}),e.jsxs("div",{className:"flex space-x-2 md:flex-row justify-end items-center",children:[e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx("input",{value:g,placeholder:"Tìm kiếm cán bộ",name:"search",onChange:t=>H(t.target.value),type:"text",className:`outline-none my-4 border rounded-md px-2 py-[6px] border-neutral-300\r
                    focus:border-blue-500 focus:border-2`})}),e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx(u,{value:v,options:M,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Đơn vị công tác tính đến năm đã chọn",onChange:t=>w(t)})}),e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx("input",{value:r,placeholder:"Số lượt tối thiểu đạt xếp loại",min:0,name:"luot",onChange:t=>C(t.target.value),type:"number",className:`outline-none my-4 border rounded-md px-2 py-[6px] border-neutral-300\r
                    focus:border-blue-500 focus:border-2`})}),e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx(u,{value:d,options:[{value:"total_htxsnv_canhan",label:"Hoàn thành xuất sắc nhiệm vụ"},{value:"total_httnv_canhan",label:"Hoàn thành tốt nhiệm vụ"},{value:"total_htnv_canhan",label:"Hoàn thành nhiệm vụ"},{value:"total_khtnv_canhan",label:"Không hoàn thành nhiệm vụ"},{value:"total_not_value_canhan",label:"Chưa có dữ liệu"}],className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Xếp loại tính theo số lượt tối tiểu",onChange:t=>E(t)})})]}),e.jsxs("h3",{className:"text-center italic my-2",children:["Có ít nhất ",r," lần xếp loại ",e.jsxs("span",{className:"italic text-red-600",children:['"',d.label,'"']})]}),e.jsx("div",{className:"mt-4 text-end mb-2 md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(B,{variant:"contained",color:"success",size:"small",children:e.jsxs(ue,{data:Y,headers:pe,filename:"xeploaithiduacacnam",children:[e.jsx(xe,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsx(he,{list:$,dennam:i.value})]})]})};export{Oe as default};
