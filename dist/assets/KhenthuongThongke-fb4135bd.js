import{d as ee,r as a,e as te,u as se,j as e,Q as w}from"./index-371a4e8f.js";import{d as ae}from"./Search-d057eaaa.js";import{u as ne,C as m}from"./index.esm-dbde89ce.js";import{S as u}from"./react-select.esm-68469137.js";import{C as v,d as N}from"./FileDownload-e634af8f.js";import{t as _}from"./thongkeApi-1c610a45.js";import{T as le,a as oe,b as ce}from"./TableChitietCanhan-be005eb3.js";import{c as he}from"./capkhenthuong-f4ac5283.js";import{h as ie}from"./hinhthuckhen-1ce2f73f.js";import{R as x}from"./RectangleChart-512fbbbc.js";import{B as p}from"./Button-c29e04f7.js";import"./createSvgIcon-b5eb2c40.js";import"./ButtonBase-3ca56fd5.js";import"./memoize-one.esm-8b357e52.js";import"./Link-24b18a5a.js";import"./LastPage-410e0def.js";import"./MenuItem-0a823130.js";import"./dayjs.min-9420a05b.js";import"./index-0fc6c329.js";let de=[{label:"STT",key:"stt"},{label:"Số quyết định",key:"soQD"},{label:"Hình thức",key:"hinhthuc"},{label:"Cấp khen",key:"capkhen"},{label:"Người ký",key:"nguoiky"},{label:"Tập thể, cá nhân được khen",key:"doituongkhen"},{label:"Ngày ký",key:"ngayky"},{label:"Nội dung khen",key:"noidung"}],re=[{label:"STT",key:"stt"},{label:"Tập thể",key:"doituongkhen"},{label:"Số lượt được khen thưởng",key:"soluotkhen"}],me=[{label:"STT",key:"stt"},{label:"Họ và tên",key:"doituongkhen"},{label:"Số lượt được khen thưởng",key:"soluotkhen"}];const Ve=()=>{const T=ee(t=>t.authReducer.vaitro_theodoithidua),[g,L]=a.useState([]);let[D,E]=a.useState([]),[H,K]=a.useState([]),[Q,$]=a.useState([]);const[ue,S]=te(),[b,P]=a.useState([]),[k,V]=a.useState([]),[O,z]=a.useState([]),[A,B]=a.useState([]),R=se(),[xe,q]=a.useState([]),[F,X]=a.useState([]),[pe,M]=a.useState([]),[G,I]=a.useState([]),[f,C]=a.useState([]),[J,U]=a.useState([]),[W,j]=a.useState([]);a.useEffect(()=>{(async()=>{try{let o=await he.getCapkhenthuongs(),l=await ie.getHinhthuckhens(),c=await _.getDonviDois({vaitro:T});T==="Quản trị thông thường"?(C(c.data.data_donvi.slice(0,1)),y("donvi",c.data.data_donvi.slice(0,1)[0])):C(c.data.data_donvi),U(c.data.data_doi),j(c.data.data_donvi.concat(c.data.data_doi.slice(1))),q(o.data.map(n=>({value:n._id,label:n.capkhen}))),X([{label:"Tất cả",value:""}].concat(o.data.map(n=>({value:n._id,label:n.capkhen})))),M(l.data.map(n=>({value:n._id,label:n.hinhthuckhen}))),I([{label:"Tất cả",value:""}].concat(l.data.map(n=>({value:n._id,label:n.hinhthuckhen}))))}catch(o){o.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(R("/login"),w.error(o.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(o.message)}})()},[]);const{register:i,handleSubmit:Y,control:d,resetField:ge,setValue:y,watch:h,formState:{errors:be}}=ne({defaultValues:{hinhthuc:{label:"Tất cả",value:""},capkhen:{label:"Tất cả",value:""},tungay:"",denngay:"",donvi:{label:"Tất cả",value:""},soQD:"",noidung:"",nguoiky:"",theloai:{label:"Tất cả",value:""}}}),Z=async t=>{let o={...t,hinhthuc:t.hinhthuc.value,capkhen:t.capkhen.value,theloai:t.theloai.value,donvi:t.donvi,doi:t.doi};S(!0);let l=await _.getKhenkhenthuongs(o);L(l.data.data),E(l.data.data.map((s,r)=>({stt:r+1,soQD:s.soQD,ngayky:s.ngayky,noidung:s.noidung,nguoiky:s.nguoiky,hinhthuc:s.hinhthuc.hinhthuckhen,capkhen:s.capkhen.capkhen,doituongkhen:s.doituongkhen}))),K(l.data.taptheduockhen.map((s,r)=>({stt:r+1,doituongkhen:s.doituongkhen,soluotkhen:s.soluotkhen}))),$(l.data.canhanduockhen.map((s,r)=>({stt:r+1,doituongkhen:s.doituongkhen,soluotkhen:s.soluotkhen}))),P(l.data.taptheduockhen),V(l.data.canhanduockhen);let c=0;l.data.taptheduockhen.forEach(s=>c+=s.soluotkhen),z(c);let n=0;l.data.canhanduockhen.forEach(s=>n+=s.soluotkhen),B(n),S(!1),w.success(l.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})};return a.useEffect(()=>{let t=h("donvi").value,o=[...J],l=[...f];if(t==="")j(l.concat(o.slice(1))),y("doi",{label:"Tất cả",value:""});else{let c=o.filter(s=>s.donvi===t),n=[{label:"Tất cả",value:""}].concat([h("donvi")]).concat(c);j(n),y("doi",{label:"Tất cả",value:""})}},[h("donvi")]),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Thống kê, theo dõi kết quả khen thưởng đối với tập thể và cá nhân đang công tác tại đơn vị"})}),e.jsxs("form",{onSubmit:Y(Z),className:"my-2 mt-4 shadow-gray-400 shadow-md p-4 rounded-lg","data-aos":"zoom-in-down","data-aos-once":"true",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx("h5",{className:"text-[18px] font-semibold",children:"Tra cứu khen thưởng"})}),e.jsxs("div",{className:"flex flex-wrap xl:flex-row flex-col flex-1 p-2",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Số QĐ khen thưởng: "}),e.jsx("input",{...i("soQD"),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                    focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col md:basis-1/6 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Từ ngày: "}),e.jsx("input",{...i("tungay"),type:"date",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col md:basis-1/6 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Đến ngày: "}),e.jsx("input",{...i("denngay"),type:"date",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Người ký: "}),e.jsx("input",{...i("nguoiky"),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col md:basis-full flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Nội dung khen thưởng: "}),e.jsx("input",{...i("noidung"),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Hình thức khen thưởng: "}),e.jsx(m,{control:d,name:"hinhthuc",render:({field:t})=>e.jsx(u,{options:G,className:"basic-multi-select my-4 p-1",classNamePrefix:"select",placeholder:"Vui lòng chọn hình thức khen thưởng",...t})})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Cấp khen thưởng: "}),e.jsx(m,{control:d,name:"capkhen",render:({field:t})=>e.jsx(u,{options:F,className:"basic-multi-select my-4 p-1",classNamePrefix:"select",placeholder:"Vui lòng chọn cấp khen thưởng",...t})})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Loại khen thưởng: "}),e.jsx(m,{control:d,name:"theloai",render:({field:t})=>e.jsx(u,{options:[{label:"Tất cả",value:""},{label:"Tập thể",value:"Tập thể"},{label:"Cá nhân",value:"Cá nhân"}],className:"basic-multi-select my-4 p-1",classNamePrefix:"select",placeholder:"Vui lòng chọn loại khen thưởng",...t})})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Đơn vị: "}),e.jsx(m,{control:d,name:"donvi",render:({field:t})=>e.jsx(u,{isDisabled:f.length===1,options:f,className:"basic-multi-select my-4 p-1",classNamePrefix:"select",placeholder:"Tất cả",...t})})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Tập thể được khen thưởng: "}),e.jsx(m,{control:d,name:"doi",render:({field:t})=>e.jsx(u,{options:W,className:"basic-multi-select my-4 p-1",classNamePrefix:"select",placeholder:"Tất cả",...t})})]})]}),e.jsx("div",{className:"my-2 text-center",children:e.jsxs(p,{type:"submit",color:"primary",variant:"contained",children:[e.jsx(ae,{})," Tìm kiếm dữ liệu"]})})]}),e.jsxs("div",{className:"flex mb-8 mt-12 shadow-lg shadow-slate-300 py-8",children:[e.jsx(x,{text:"Tổng số lượt khen thưởng",number:g.length,color:"bg-red-600"}),e.jsx(x,{text:"Tổng số tập thể được khen",number:b.length,color:"bg-cyan-600"}),e.jsx(x,{text:"Tổng số cá nhân được khen",number:k.length,color:"bg-blue-600"}),e.jsx(x,{text:"Tổng số lượt khen tập thể",number:O,color:"bg-pink-600"}),e.jsx(x,{text:"Tổng số lượt khen cá nhân",number:A,color:"bg-yellow-600"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mt-2 my-8 shadow-md px-2 shadow-gray-500 rounded-md",children:[e.jsx("p",{className:"text-center text-lg mt-8 pt-4 font-semibold",children:"Danh sách các quyết định khen thưởng của tập thể và cá nhân"}),e.jsx("div",{className:"mt-4 text-end md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(p,{variant:"contained",color:"success",size:"small",children:e.jsxs(v,{data:D,headers:de,filename:`danhsachkhenthuong_${h("tungay")}_${h("denngay")}`,children:[e.jsx(N,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsxs("p",{className:"my-2 px-4 text-end",children:["Tổng số: ",e.jsx("span",{className:"font-semibold text-2xl text-red-600",children:g.length})," lượt khen thưởng"]}),e.jsx(le,{list:g})]}),e.jsxs("div",{className:"my-4",children:[e.jsxs("div",{className:"mt-2 my-8 shadow-md px-2 shadow-gray-500 rounded-md",children:[e.jsx("p",{className:"text-center text-lg mt-8 pt-4 font-semibold",children:"Danh sách tập thể và số lượt khen thưởng của tập thể"}),e.jsx("div",{className:"mt-4 text-end md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(p,{variant:"contained",color:"success",size:"small",children:e.jsxs(v,{data:H,headers:re,filename:`danhsachkhenthuongtapthe_${h("tungay")}_${h("denngay")}`,children:[e.jsx(N,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsxs("p",{className:"my-2 px-4 text-end",children:["Tổng số: ",e.jsx("span",{className:"font-semibold text-2xl text-red-600",children:b.length})," tập thể được khen thưởng"]}),e.jsx(oe,{list:b})]}),e.jsxs("div",{className:"mt-2 my-8 shadow-md px-2 shadow-gray-500 rounded-md",children:[e.jsx("p",{className:"text-center text-lg mt-8 pt-4 font-semibold",children:"Danh sách cá nhân và số lượt khen thưởng của cá nhân"}),e.jsx("div",{className:"mt-4 text-end md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(p,{variant:"contained",color:"success",size:"small",children:e.jsxs(v,{data:Q,headers:me,filename:`danhsachkhenthuongcanhan_${h("tungay")}_${h("denngay")}`,children:[e.jsx(N,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsxs("p",{className:"my-2 px-4 text-end",children:["Tổng số: ",e.jsx("span",{className:"font-semibold text-2xl text-red-600",children:k.length})," cá nhân được khen thưởng"]}),e.jsx(ce,{list:k})]})]})]})]})};export{Ve as default};
