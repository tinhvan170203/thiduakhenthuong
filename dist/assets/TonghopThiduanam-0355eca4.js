import{d as ae,r as a,u as se,e as le,j as e,f as ne}from"./index-469ebc4a.js";import{S as u}from"./react-select.esm-ea0f231f.js";import{u as oe}from"./index.esm-e24acc70.js";import{c as ce}from"./canboApi-a16ae5b6.js";import{t as ie}from"./thongkeApi-7ce5f50b.js";import{d as re}from"./BarChart-aae44862.js";import{S as he}from"./SettingSendUser-11058275.js";import{R as m}from"./RectangleChart-a9fb17bf.js";import"./TableChitietThiduathangTonghop-84c6d80a.js";import"./dayjs.min-e05fe7c1.js";import{D as de}from"./DoughnutChart-528e67fa.js";import{T as me}from"./TableChitietThiduanamTonghop-5ebb9645.js";import{C as ue,d as xe}from"./FileDownload-8fac1ea7.js";import{B}from"./Button-e3d685a6.js";import"./memoize-one.esm-c82963f8.js";import"./ButtonBase-ea83d2d9.js";import"./createSvgIcon-e7baeffd.js";import"./index.esm-a80e06b2.js";import"./index-bfd39377.js";import"./LastPage-511a91a0.js";import"./MenuItem-22e0308b.js";import"./index-2d5c9321.js";import"./Link-3fd13359.js";let pe=[{label:"STT",key:"stt"},{label:"Họ tên",key:"hoten"},{label:"Đơn vị đang công tác",key:"donvidangcongtac"},{label:"Kết quả xếp loại thi đua năm",key:"xeploai"}];const Re=()=>{const Y=ae(t=>t.authReducer.vaitro_theodoithidua);a.useState([]);const[q,x]=a.useState([]),[o,T]=a.useState({label:2025,value:2025}),[c,p]=a.useState({label:2025,value:2025}),[r,k]=a.useState(""),[A,K]=a.useState(!1),[C,L]=a.useState([]),[O,P]=a.useState([]),R=se(),[ve,_]=le(),[fe,X]=a.useState(0),[ge,F]=a.useState(""),[D,G]=a.useState([]),[M,U]=a.useState([]),[v,w]=a.useState({label:"",value:""});a.useState([]);const[f,H]=a.useState(""),[V,z]=a.useState([]),[$,g]=a.useState([]),[b,Q]=a.useState(0),[j,I]=a.useState(0),[y,J]=a.useState(0),[N,W]=a.useState(0),[S,Z]=a.useState(0),[h,E]=a.useState({label:"Chưa chọn xếp loại tính theo số lượt tối tiểu",value:""});oe({defaultValues:{donvi:{label:"Tất cả",value:""},nam:"",denngay:"",hoten:""}}),a.useEffect(()=>{(async()=>{try{let s=await ce.fetchYearMonth(),n=await ne.getUserOfKhoi({vaitro:Y});P(n.data),T({label:s.data.year-1,value:s.data.year-1}),p({label:s.data.year,value:s.data.year}),X(s.data.year),F(s.data.year);let l=[];for(let i=s.data.year;i>=2022;i--)l.push({label:i,value:i});G(l)}catch(s){s.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(R("/login"),toast.error(s.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(s.message)}})()},[]);const ee=async t=>{let s=[...t];L(s.map(n=>n.value)),K(!1)},te=async()=>{if(C.length===0){alert("Vui lòng chọn đơn vị cần thống kê kết quả");return}_(!0);try{let t=await ie.getBangThiduanams({tunam:o,dennam:c,donvis:C});z(t.data.data),g(t.data.data),U([{label:"Tất cả",value:""}].concat(t.data.list_doi_option)),I(t.data.total_khtnv),J(t.data.total_htnv),W(t.data.total_httnv),Z(t.data.total_htxsnv),Q(t.data.total_not_value),H(""),w({label:"Tất cả",value:""}),E({label:"Chưa chọn xếp loại tính theo số lượt tối tiểu",value:""}),_(!1),x(t.data.data.map((s,n)=>({stt:n+1,hoten:s.hoten,donvidangcongtac:s.donvidangcongtac,xeploai:s.result.map(l=>`${l.nam}: ${l.result}`),ghichu:s.ghichu})))}catch(t){console.log(t)}};return a.useEffect(()=>{c.value<o.value&&(alert("Giá trị đến năm phải lớn hơn hoặc bằng giá trị từ năm"),p({label:o.label,value:o.value}))},[c,o]),a.useEffect(()=>{let t=[...V];if(t.length>0){const s=setTimeout(()=>{let n=t.filter(l=>l.hoten.toLowerCase().includes(f.toLowerCase())&&l.id_donvidangcongtac.includes(v.value));g(n),x(n.map((l,i)=>({stt:i+1,hoten:l.hoten,donvidangcongtac:l.donvidangcongtac,xeploai:l.result.map(d=>` ${d.nam}: ${d.result}`)})))},500);return()=>clearTimeout(s)}},[f,v]),a.useEffect(()=>{let t=[...V];if(r<0){alert("Vui lòng chọn giá trị số lượt tối thiểu lớn hơn 0"),k("");return}if(h.value!==""&&t.length>0){const s=setTimeout(()=>{let n=t.filter(l=>l[h.value]>=r);g(n),x(n.map((l,i)=>({stt:i+1,hoten:l.hoten,donvidangcongtac:l.donvidangcongtac,xeploai:l.result.map(d=>`${d.nam}: ${d.result}`)})))},400);return()=>clearTimeout(s)}},[r,h]),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Thống kê, theo dõi kết quả thi đua năm của cán bộ, chiến sĩ trong khoảng thời gian năm"})}),e.jsxs("div",{className:"shadow-gray-400  shadow-md p-4 rounded-sm",children:[e.jsxs("div",{className:"my-2 mt-4 flex justify-center flex-wrap",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Từ năm: "}),e.jsx(u,{options:D,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Đơn vị công tác tính đến ngày xếp loại cờ xanh, vàng",onChange:t=>T(t),value:o})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Đến năm: "}),e.jsx(u,{options:D,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Đơn vị công tác tính đến ngày xếp loại cờ xanh, vàng",onChange:t=>p(t),value:c})]}),e.jsx("div",{className:"flex-col px-1 flex items-end justify-center",children:e.jsxs(B,{variant:"contained",onClick:()=>te(),style:{width:"200px"},color:"primary",children:[e.jsx(re,{})," Thống kê dữ liệu"]})})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex px-1",children:[e.jsx("label",{className:"font-semibold",children:"Đơn vị: "}),e.jsx(he,{onSubmit:ee,list:O,resetCheckbox:A})]})]}),e.jsx("p",{className:"text-red-600 font-medium text-center mt-8",children:`Biểu đồ kết quả xếp loại thi đua năm từ năm ${o.value} đến năm ${c.value}`}),e.jsx("div",{className:"flex mb-8 mt-2 justify-center items-center shadow-lg shadow-slate-300 py-8",children:e.jsx("div",{className:"md:basis-1/4",children:e.jsx(de,{text:`Biểu đồ kết quả thi đua năm của cán bộ, chiến sĩ từ năm ${o.value} đến năm ${c.value}`,dataHTNV:y,dataHTTNV:N,dataHTXSNV:S,dataKHTNV:j,dataNotValue:b,total:y+N+S+j+b})})}),e.jsxs("div",{className:"shadow-lg  mb-8 pb-8 shadow-slate-300 ",children:[e.jsxs("div",{className:"flex mt-4",children:[e.jsx(m,{text:"Hoàn thành xuất sắc nhiệm vụ",number:S,color:"bg-red-600"}),e.jsx(m,{text:"Hoàn thành tốt nhiệm vụ",number:N,color:"bg-cyan-600"}),e.jsx(m,{text:"Hoàn thành nhiệm vụ",number:y,color:"bg-blue-600"}),e.jsx(m,{text:"Không hoàn thành nhiệm vụ",number:j,color:"bg-pink-600"}),e.jsx(m,{text:"Chưa có dữ liệu",number:b,color:"bg-yellow-600"})]}),e.jsx("p",{className:"text-blue-600 font-medium text-center mt-2",children:"Thống kê số lượt xếp loại thi đua năm"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-center text-lg mt-8 font-semibold",children:"Danh sách xếp loại thi đua năm của cán bộ, chiến sĩ"}),e.jsxs("h3",{className:"text-center italic",children:["(từ năm ",o.value," đến năm ",c.value,")"]}),e.jsxs("h3",{className:"text-end my-4",children:["Tổng số: ",e.jsx("span",{className:"text-xl font-bold text-red-600",children:$.length})," cán bộ, chiến sĩ"]}),e.jsxs("div",{className:"flex space-x-2 md:flex-row justify-end items-center",children:[e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx("input",{value:f,placeholder:"Tìm kiếm cán bộ",name:"search",onChange:t=>H(t.target.value),type:"text",className:`outline-none my-4 border rounded-md px-2 py-[6px] border-neutral-300\r
                    focus:border-blue-500 focus:border-2`})}),e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx(u,{value:v,options:M,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Đơn vị công tác tính đến năm đã chọn",onChange:t=>w(t)})}),e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx("input",{value:r,placeholder:"Số lượt tối thiểu đạt xếp loại",min:0,name:"luot",onChange:t=>k(t.target.value),type:"number",className:`outline-none my-4 border rounded-md px-2 py-[6px] border-neutral-300\r
                    focus:border-blue-500 focus:border-2`})}),e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx(u,{value:h,options:[{value:"total_htxsnv_canhan",label:"Hoàn thành xuất sắc nhiệm vụ"},{value:"total_httnv_canhan",label:"Hoàn thành tốt nhiệm vụ"},{value:"total_htnv_canhan",label:"Hoàn thành nhiệm vụ"},{value:"total_khtnv_canhan",label:"Không hoàn thành nhiệm vụ"},{value:"total_not_value_canhan",label:"Chưa có dữ liệu"}],className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Xếp loại tính theo số lượt tối tiểu",onChange:t=>E(t)})})]}),e.jsxs("h3",{className:"text-center italic my-2",children:["Có ít nhất ",r," lần xếp loại ",e.jsxs("span",{className:"italic text-red-600",children:['"',h.label,'"']})]}),e.jsx("div",{className:"mt-4 text-end mb-2 md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(B,{variant:"contained",color:"success",size:"small",children:e.jsxs(ue,{data:q,headers:pe,filename:"xeploaithiduanam",children:[e.jsx(xe,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsx("div",{className:"mb-8",children:e.jsx(me,{list:$,dennam:c.value})})]})]})};export{Re as default};
