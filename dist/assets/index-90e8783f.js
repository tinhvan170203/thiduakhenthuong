import{r as h,d as S,j as e,c as V,s as W,u as A,Q as j,N as I,e as Q}from"./index-371a4e8f.js";import"./index.esm-a80e06b2.js";import{u as R}from"./index.esm-dbde89ce.js";import{d as q}from"./Add-b80d7046.js";import{D as K}from"./DialogDelete-f47675d7.js";import{T,a as c,P as N,b as G,c as J,d as U,e as X,f as Y,g as B,h as w,i as O,j as _}from"./LastPage-410e0def.js";import{d as Z}from"./Edit-3f190fda.js";import{d as ee,a as se}from"./AutoAwesomeMotion-e68ec9ef.js";import{B as P}from"./Button-c29e04f7.js";import{P as ae,B as $,I as y}from"./MenuItem-0a823130.js";import{b as v}from"./bachamApi-28ca81bb.js";import{S as te,D as re,a as le,d as ne,b as oe}from"./Cancel-e1a5b8c1.js";import{D as ie}from"./DialogActions-8285de49.js";import"./createSvgIcon-b5eb2c40.js";import"./ButtonBase-3ca56fd5.js";const de=({row:l,page:r,rowsPerPage:o,index:a,onClickOpenDialogEdit:i,onClickOpenDialogDelete:s})=>(h.useState(null),S(u=>u.authReducer.roles_quanlydoanvien),e.jsxs(T,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(c,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:r*o+a}),e.jsx(c,{className:"border-r border-slate-300",align:"left",children:l.bacham}),e.jsx(c,{className:"border-r border-slate-300",align:"left",children:l.nienhan}),e.jsx(c,{className:"border-r border-slate-300",align:"left",children:l.thutu}),e.jsxs(c,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[e.jsx(P,{variant:"contained",color:"info",size:"small",onClick:()=>i(l),children:e.jsx(Z,{style:{fontSize:"20px"}})}),e.jsx(P,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>s(l._id),children:e.jsx(ee,{style:{fontSize:"20px"}})})]})]},l._id));function E(l){const r=V(),{count:o,page:a,rowsPerPage:i,onPageChange:s}=l,u=t=>{s(t,0)},f=t=>{s(t,a-1)},m=t=>{s(t,a+1)},C=t=>{s(t,Math.max(0,Math.ceil(o/i)-1))};return e.jsxs($,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(y,{onClick:u,disabled:a===0,"aria-label":"first page",children:r.direction==="rtl"?e.jsx(B,{}):e.jsx(w,{})}),e.jsx(y,{onClick:f,disabled:a===0,"aria-label":"previous page",children:r.direction==="rtl"?e.jsx(O,{}):e.jsx(_,{})}),e.jsx(y,{onClick:m,disabled:a>=Math.ceil(o/i)-1,"aria-label":"next page",children:r.direction==="rtl"?e.jsx(_,{}):e.jsx(O,{})}),e.jsx(y,{onClick:C,disabled:a>=Math.ceil(o/i)-1,"aria-label":"last page",children:r.direction==="rtl"?e.jsx(w,{}):e.jsx(B,{})})]})}E.propTypes={count:N.number.isRequired,onPageChange:N.func.isRequired,page:N.number.isRequired,rowsPerPage:N.number.isRequired};function ce({list:l,onClickOpenDialogEdit:r,onClickOpenDialogDelete:o}){const[a,i]=h.useState(0),[s,u]=h.useState(10),f=a>0?Math.max(0,(1+a)*s-l.length):0,m=(t,d)=>{i(d)},C=t=>{u(parseInt(t.target.value,10)),i(0)};return e.jsxs(e.Fragment,{children:[e.jsx(G,{component:ae,children:e.jsxs(J,{"aria-label":"custom pagination table",children:[e.jsx(U,{children:e.jsxs(T,{children:[e.jsx(c,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(c,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Cấp bậc hàm"}),e.jsx(c,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Niên hạn"}),e.jsx(c,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Thứ tự"}),e.jsx(c,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(X,{children:[(s>0?l.slice(a*s,a*s+s):l).map((t,d)=>e.jsx(de,{row:t,page:a,rowsPerPage:s,index:d+1,onClickOpenDialogEdit:r,onClickOpenDialogDelete:o},t._id)),f>0&&e.jsx(T,{style:{height:53*f},children:e.jsx(c,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(Y,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:l.length,rowsPerPage:s,page:a,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:m,onRowsPerPageChange:C,ActionsComponent:E,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:d,to:b,count:p}){return`hiển thị ${d} đến ${b} bản ghi trong tổng số ${p!==-1?p:`more than ${b}`} bản ghi`}})})]})}const ue=h.forwardRef(function(r,o){return e.jsx(te,{direction:"up",ref:o,...r})}),he=W(y)({position:"absolute",right:"16px",top:"4px"});function me({open:l,item:r,onCloseDialogEdit:o,onSubmit:a}){const{register:i,handleSubmit:s,control:u,resetField:f,setValue:m,watch:C,formState:{errors:t}}=R({defaultValues:{bacham:"",nienhan:2,thutu:1,status:!0}});h.useState([]),h.useEffect(()=>{r&&(m("bacham",r.bacham,{shouldValidate:!0}),m("nienhan",r.nienhan,{shouldValidate:!0}),m("thutu",r.thutu,{shouldValidate:!0}))},[r]);const d=async b=>{if(a){const p={...b,id_edit:r._id};await a(p),o()}};return e.jsx(e.Fragment,{children:e.jsxs(re,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(b,p)=>{p!=="backdropClick"&&o(b,p)},open:l,TransitionComponent:ue,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(le,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"#03528f",margin:"0px"},children:[e.jsx(se,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa bậc hàm"}),e.jsx(he,{onClick:()=>o(),children:e.jsx(ne,{style:{color:"white"}})})]}),e.jsx(oe,{children:e.jsx($,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:s(d),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Cấp bậc: "]}),e.jsx("input",{...i("bacham",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Niên hạn lên bậc hàm tiếp theo tính theo năm: "]}),e.jsx("input",{...i("nienhan",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...i("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]})]}),e.jsx(ie,{children:e.jsxs(P,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx(q,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const _e=()=>{let l=S(n=>n.authReducer.vaitro_theodoithidua);const r=A();if(l!=="Quản trị hệ thống")return j.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(I,{to:"/login",replace:!0});const[o,a]=h.useState([]),[i,s]=Q(),[u,f]=h.useState({status:!1,item:null}),m=()=>{f({...u,status:!1})},C=n=>{f({item:n,status:!0})},[t,d]=h.useState({status:!1,id_Delete:null}),b=n=>{d({status:!0,id_Delete:n})},p=()=>{d({...t,status:!1})},z=()=>{d({...t,status:!1})};S(n=>n.authReducer.roles_theodoithidua);const{register:k,handleSubmit:H,control:pe,resetField:D,watch:ge,formState:{errors:xe}}=R({defaultValues:{bacham:"",thutu:1,nienhan:2}});h.useEffect(()=>{(async()=>{try{s(!0);let g=await v.getBachams();a(g.data),setTimeout(()=>{s(!1)},400)}catch(g){g.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(r("/login"),s(!1),j.error(g.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(g.message)}})()},[]);const F=async n=>{let g={...n};s(!0);try{let x=await v.addBacham(g);a(x.data.bachamList),setTimeout(()=>{s(!1)},400),D("bacham"),D("nienhan"),D("thutu"),j.success(x.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(x){j.error(x.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},L=async n=>{let g={...n};s(!0);try{let x=await v.editBacham(g);a(x.data.bachamList),setTimeout(()=>{s(!1)},400),j.success(x.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(x){j.error(x.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},M=async()=>{s(!0);try{let n=await v.deleteBacham(t.id_Delete);a(n.data.bachamList),s(!1),d({...t,status:!1}),j.success(n.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(n){d({...t,status:!1}),j.error(n.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}};return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Cấu hình cấp bậc quân hàm"})}),e.jsxs("form",{className:"mt-2 px-6 py-4 shadow-gray-400 shadow-md",onSubmit:H(F),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Tên cấp bậc hàm: "]}),e.jsx("input",{...k("bacham",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Niên hạn lên hàm tiếp theo: "]}),e.jsx("input",{...k("nienhan",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...k("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]})]}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(P,{type:"submit",color:"primary",variant:"contained",children:[e.jsx(q,{})," Thêm mới"]})})]}),e.jsx("div",{className:"mt-6 px-2 shadow-black shadow-sm",children:e.jsx(ce,{list:o,onClickOpenDialogDelete:b,onClickOpenDialogEdit:C})}),e.jsx(me,{open:u.status,item:u.item,onCloseDialogEdit:m,onSubmit:L}),e.jsx(K,{open:t.status,onCloseDialogDelete:z,onConfirmDelete:M,onCancelDelete:p})]})};export{_e as default};
