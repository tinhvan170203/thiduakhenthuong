import{d as I,r as s,u as J,e as W,j as e,f as Z}from"./index-371a4e8f.js";import{u as ee}from"./index.esm-dbde89ce.js";import{c as te}from"./canboApi-98c0e799.js";import{t as ne}from"./thongkeApi-1c610a45.js";import{d as ae}from"./BarChart-5733c919.js";import{S as se}from"./SettingSendUser-d5b98a8c.js";import{R as r}from"./RectangleChart-512fbbbc.js";import{d as h}from"./dayjs.min-9420a05b.js";import{T as le,a as oe,b as he}from"./TableChitietCanhan-be005eb3.js";import{C as k,d as y}from"./FileDownload-e634af8f.js";import{B as d}from"./Button-c29e04f7.js";import"./createSvgIcon-b5eb2c40.js";import"./ButtonBase-3ca56fd5.js";import"./index.esm-a80e06b2.js";import"./index-0fc6c329.js";import"./LastPage-410e0def.js";import"./MenuItem-0a823130.js";import"./Link-24b18a5a.js";let ce=[{label:"STT",key:"stt"},{label:"Số quyết định",key:"soQD"},{label:"Hình thức",key:"hinhthuc"},{label:"Cấp khen",key:"capkhen"},{label:"Người ký",key:"nguoiky"},{label:"Tập thể, cá nhân được khen",key:"doituongkhen"},{label:"Ngày ký",key:"ngayky"},{label:"Nội dung khen",key:"noidung"}],re=[{label:"STT",key:"stt"},{label:"Tập thể",key:"doituongkhen"},{label:"Số lượt được khen thưởng",key:"soluotkhen"}],de=[{label:"STT",key:"stt"},{label:"Họ và tên",key:"doituongkhen"},{label:"Số lượt được khen thưởng",key:"soluotkhen"}];const $e=()=>{const Y=I(t=>t.authReducer.vaitro_theodoithidua),[i,C]=s.useState([]),[m,f]=s.useState(""),[u,b]=s.useState(""),[D,w]=s.useState(!1),[j,E]=s.useState([]),[M,_]=s.useState([]),K=J(),[ie,N]=W(),[x,$]=s.useState("");let[A,L]=s.useState([]),[q,R]=s.useState([]),[V,F]=s.useState([]);const[g,O]=s.useState([]),[p,z]=s.useState([]),[B,T]=s.useState([]),[H,Q]=s.useState([]),[X,U]=s.useState([]),{register:v,handleSubmit:me,control:ue,resetField:xe,setValue:S,watch:l,formState:{errors:ge}}=ee({defaultValues:{donvi:{label:"Tất cả",value:""},tungay:"",denngay:"",hoten:""}});s.useEffect(()=>{(async()=>{try{let a=await te.fetchYearMonth(),o=await Z.getUserOfKhoi({vaitro:Y});_(o.data),S("tungay",a.data.year+"-01-01"),S("denngay",a.data.year+`-${("0"+a.data.month).slice(-2)}-15`),f(a.data.year+"-01-01"),b(a.data.year+`-${("0"+a.data.month).slice(-2)}-15`)}catch(a){a.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(K("/login"),toast.error(a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(a.message)}})()},[]);const G=async t=>{let a=[...t];E(a.map(o=>o.value)),w(!1)},P=async()=>{if(j.length===0){alert("Vui lòng chọn đơn vị cần thống kê kết quả");return}N(!0);try{let t=await ne.getKhenkhenthuongsTheothoigian({donvis:j,tungay:l("tungay"),denngay:l("denngay")});C(t.data.data),L(t.data.data.map((n,c)=>({stt:c+1,soQD:n.soQD,ngayky:n.ngayky,noidung:n.noidung,nguoiky:n.nguoiky,hinhthuc:n.hinhthuc.hinhthuckhen,capkhen:n.capkhen.capkhen,doituongkhen:n.doituongkhen}))),R(t.data.taptheduockhen.map((n,c)=>({stt:c+1,doituongkhen:n.doituongkhen,soluotkhen:n.soluotkhen}))),F(t.data.canhanduockhen.map((n,c)=>({stt:c+1,doituongkhen:n.doituongkhen,soluotkhen:n.soluotkhen}))),f(l("tungay")),b(l("denngay")),O(t.data.taptheduockhen),z(t.data.canhanduockhen),T(t.data.canhanduockhen);let a=0;t.data.taptheduockhen.forEach(n=>a+=n.soluotkhen),Q(a);let o=0;t.data.canhanduockhen.forEach(n=>o+=n.soluotkhen),U(o),N(!1)}catch(t){console.log(t)}};return s.useEffect(()=>{let t=[...p];if(t.length>0){const a=setTimeout(()=>{let o=t.filter(n=>n.doituongkhen.toLowerCase().includes(x.toLowerCase()));T(o)},500);return()=>clearTimeout(a)}},[x]),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Thống kê, theo dõi kết quả khen thưởng theo khoảng thời gian"})}),e.jsxs("div",{className:"shadow-gray-400  shadow-md p-4 rounded-sm",children:[e.jsxs("div",{className:"my-2 mt-4 flex justify-center flex-wrap",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Từ ngày: "}),e.jsx("input",{...v("tungay"),type:"date",className:`outline-none my-4 border rounded-md px-2 py-1 border-neutral-300\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Đến ngày: "}),e.jsx("input",{...v("denngay"),type:"date",className:`outline-none my-4 border rounded-md px-2 py-1 border-neutral-300\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsx("div",{className:"flex-col px-1 flex items-end justify-center",children:e.jsxs(d,{variant:"contained",onClick:()=>P(),style:{width:"200px"},color:"primary",children:[e.jsx(ae,{})," Thống kê dữ liệu"]})})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex px-1",children:[e.jsx("label",{className:"font-semibold",children:"Đơn vị: "}),e.jsx(se,{onSubmit:G,list:M,resetCheckbox:D})]})]}),e.jsxs("div",{className:"flex mb-8 mt-12 shadow-lg shadow-slate-300 py-8",children:[e.jsx(r,{text:"Tổng số lượt khen thưởng",number:i.length,color:"bg-red-600"}),e.jsx(r,{text:"Tổng số tập thể được khen",number:g.length,color:"bg-cyan-600"}),e.jsx(r,{text:"Tổng số cá nhân được khen",number:p.length,color:"bg-blue-600"}),e.jsx(r,{text:"Tổng số lượt khen tập thể",number:H,color:"bg-pink-600"}),e.jsx(r,{text:"Tổng số lượt khen cá nhân",number:X,color:"bg-yellow-600"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-center text-lg mt-8 font-semibold",children:"Danh sách các quyết định khen thưởng của tập thể và cá nhân"}),e.jsxs("h3",{className:"text-center italic mb-4",children:["(từ ngày ",h(m).format("DD/MM/YYYY")," đến ngày ",h(u).format("DD/MM/YYYY"),")"]}),e.jsx("div",{className:"mt-4 text-end md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(d,{variant:"contained",color:"success",size:"small",children:e.jsxs(k,{data:A,headers:ce,filename:`danhsachkhenthuong_${l("tungay")}_${l("denngay")}`,children:[e.jsx(y,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsxs("p",{className:"mb-4 text-end",children:["Tổng số: ",e.jsx("span",{className:"text-2xl text-red-600 font-bold",children:i.length})," quyết định khen thưởng"]}),e.jsx(le,{list:i}),e.jsxs("div",{className:"my-4",children:[e.jsxs("div",{className:"my-4",children:[e.jsx("p",{className:"text-center text-lg mt-8 font-semibold",children:"Danh sách tập thể và số lượt khen thưởng của tập thể"}),e.jsxs("h3",{className:"text-center italic mb-4",children:["(từ ngày ",h(m).format("DD/MM/YYYY")," đến ngày ",h(u).format("DD/MM/YYYY"),")"]}),e.jsx("div",{className:"mt-4 text-end md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(d,{variant:"contained",color:"success",size:"small",children:e.jsxs(k,{data:q,headers:re,filename:`danhsachkhenthuongtapthe_${l("tungay")}_${l("denngay")}`,children:[e.jsx(y,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsxs("p",{className:"my-2 px-4 text-end",children:["Tổng số: ",e.jsx("span",{className:"font-semibold text-2xl text-red-600",children:g.length})," tập thể được khen thưởng"]}),e.jsx(oe,{list:g})]}),e.jsxs("div",{className:"my-4",children:[e.jsx("p",{className:"text-center text-lg mt-8 font-semibold",children:"Danh sách cá nhân và số lượt khen thưởng của cá nhân"}),e.jsxs("h3",{className:"text-center italic mb-4",children:["(từ ngày ",h(m).format("DD/MM/YYYY")," đến ngày ",h(u).format("DD/MM/YYYY"),")"]}),e.jsx("div",{className:"mt-4 text-end md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(d,{variant:"contained",color:"success",size:"small",children:e.jsxs(k,{data:V,headers:de,filename:`danhsachkhenthuongcanhan_${l("tungay")}_${l("denngay")}`,children:[e.jsx(y,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsxs("p",{className:"mt-2 px-4 text-end",children:["Tổng số: ",e.jsx("span",{className:"font-semibold text-2xl text-red-600",children:p.length})," cá nhân được khen thưởng"]}),e.jsx("div",{className:"px-1 text-end",children:e.jsx("input",{value:x,placeholder:"Tìm kiếm cán bộ, chiến sĩ",name:"search",onChange:t=>$(t.target.value),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-300\r
                    focus:border-blue-500 focus:border-2`})}),e.jsx(he,{list:B})]})]})]})]})};export{$e as default};
