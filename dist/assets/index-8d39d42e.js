import{r as u,j as e,c as G,s as J,d as w,u as U,Q as j,h as X,e as Y}from"./index-371a4e8f.js";import"./index.esm-a80e06b2.js";import{u as z,C as $}from"./index.esm-dbde89ce.js";import{d as q}from"./Add-b80d7046.js";import{q as Z}from"./base-e8aaf39e.js";import{D as ee}from"./DialogDelete-f47675d7.js";import{d as D}from"./doiApi-e594bd3e.js";import{T as k,a as m,P as N,b as se,c as te,d as ae,e as re,f as le,g as O,h as B,i as _,j as R}from"./LastPage-410e0def.js";import{d as ne}from"./Edit-3f190fda.js";import{d as oe,a as ie}from"./AutoAwesomeMotion-e68ec9ef.js";import{B as C}from"./Button-c29e04f7.js";import{P as de,B as E,I as y}from"./MenuItem-0a823130.js";import{S as ce,D as ue,a as he,d as ge,b as pe}from"./Cancel-e1a5b8c1.js";import{S as H}from"./Switch-4739740e.js";import{D as xe}from"./DialogActions-8285de49.js";import"./createSvgIcon-b5eb2c40.js";import"./ButtonBase-3ca56fd5.js";const me=({row:l,page:r,rowsPerPage:o,index:t,onClickOpenDialogEdit:c,onClickOpenDialogDelete:s})=>(u.useState(null),e.jsxs(k,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(m,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:r*o+t}),e.jsx(m,{className:"border-r border-slate-300",align:"left",children:l.tendoi}),e.jsx(m,{className:"border-r border-slate-300",align:"left",children:l.thutu}),e.jsx(m,{className:"border-r border-slate-300",align:"left",children:l.status===!0?e.jsx(C,{color:"success",style:{width:"160px"},size:"small",variant:"contained",children:"Sử dụng"}):e.jsx(C,{color:"error",style:{width:"160px"},size:"small",variant:"contained",children:"Không sử dụng"})}),e.jsxs(m,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[e.jsx(C,{variant:"contained",color:"info",size:"small",onClick:()=>c(l),children:e.jsx(ne,{style:{fontSize:"20px"}})}),e.jsx(C,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>s(l._id),children:e.jsx(oe,{style:{fontSize:"20px"}})})]})]},l._id));function V(l){const r=G(),{count:o,page:t,rowsPerPage:c,onPageChange:s}=l,h=n=>{s(n,0)},f=n=>{s(n,t-1)},g=n=>{s(n,t+1)},v=n=>{s(n,Math.max(0,Math.ceil(o/c)-1))};return e.jsxs(E,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(y,{onClick:h,disabled:t===0,"aria-label":"first page",children:r.direction==="rtl"?e.jsx(O,{}):e.jsx(B,{})}),e.jsx(y,{onClick:f,disabled:t===0,"aria-label":"previous page",children:r.direction==="rtl"?e.jsx(_,{}):e.jsx(R,{})}),e.jsx(y,{onClick:g,disabled:t>=Math.ceil(o/c)-1,"aria-label":"next page",children:r.direction==="rtl"?e.jsx(R,{}):e.jsx(_,{})}),e.jsx(y,{onClick:v,disabled:t>=Math.ceil(o/c)-1,"aria-label":"last page",children:r.direction==="rtl"?e.jsx(B,{}):e.jsx(O,{})})]})}V.propTypes={count:N.number.isRequired,onPageChange:N.func.isRequired,page:N.number.isRequired,rowsPerPage:N.number.isRequired};function fe({list:l,onClickOpenDialogEdit:r,onClickOpenDialogDelete:o}){const[t,c]=u.useState(0),[s,h]=u.useState(10),f=t>0?Math.max(0,(1+t)*s-l.length):0,g=(n,i)=>{c(i)},v=n=>{h(parseInt(n.target.value,10)),c(0)};return e.jsxs(e.Fragment,{children:[e.jsx(se,{component:de,children:e.jsxs(te,{"aria-label":"custom pagination table",children:[e.jsx(ae,{children:e.jsxs(k,{children:[e.jsx(m,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(m,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Tên đội, công an cấp xã"}),e.jsx(m,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Thứ tự"}),e.jsx(m,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(143 1 1)"},children:"Trạng thái"}),e.jsx(m,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(re,{children:[(s>0?l.slice(t*s,t*s+s):l).map((n,i)=>e.jsx(me,{row:n,page:t,rowsPerPage:s,index:i+1,onClickOpenDialogEdit:r,onClickOpenDialogDelete:o},n._id)),f>0&&e.jsx(k,{style:{height:53*f},children:e.jsx(m,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(le,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:l.length,rowsPerPage:s,page:t,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:g,onRowsPerPageChange:v,ActionsComponent:V,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:i,to:d,count:p}){return`hiển thị ${i} đến ${d} bản ghi trong tổng số ${p!==-1?p:`more than ${d}`} bản ghi`}})})]})}const be=u.forwardRef(function(r,o){return e.jsx(ce,{direction:"up",ref:o,...r})}),je=J(y)({position:"absolute",right:"16px",top:"4px"});function ve({open:l,item:r,onCloseDialogEdit:o,onSubmit:t}){const{register:c,handleSubmit:s,control:h,resetField:f,setValue:g,watch:v,formState:{errors:n}}=z({defaultValues:{tendoi:"",donvi:"",thutu:1,status:!0}});u.useEffect(()=>{r&&(g("tendoi",r.tendoi,{shouldValidate:!0}),g("thutu",r.thutu,{shouldValidate:!0}),g("status",r.status,{shouldValidate:!0}),g("donvi",{label:r.donvi.tentaikhoan,value:r.donvi._id},{shouldValidate:!0}))},[r]);const i=async d=>{if(t){const p={...d,id_edit:r._id};await t(p),o()}};return e.jsx(e.Fragment,{children:e.jsxs(ue,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(d,p)=>{p!=="backdropClick"&&o(d,p)},open:l,TransitionComponent:be,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(he,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"#03528f",margin:"0px"},children:[e.jsx(ie,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa đội nghiệp vụ, công an cấp xã"}),e.jsx(je,{onClick:()=>o(),children:e.jsx(ge,{style:{color:"white"}})})]}),e.jsx(pe,{children:e.jsx(E,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:s(i),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Tên đội nghiệp vụ, công an cấp xã: "]}),e.jsx("input",{...c("tendoi",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...c("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái sử dụng:"}),e.jsx($,{name:"status",control:h,render:({field:{value:d,onChange:p}})=>e.jsx(H,{checked:d,onChange:p})})]})]}),e.jsx(xe,{children:e.jsxs(C,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx(q,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const Me=()=>{let l=w(a=>a.authReducer.vaitro_theodoithidua);const r=U();if(l!=="Quản trị thông thường")return j.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(Navigate,{to:"/login",replace:!0});X();const[o,t]=u.useState([]),[c,s]=Y();u.useState(""),u.useState("");const h=u.useMemo(()=>{const a=Z.parse(location.search);return{...a,tendoi:a.tendoi||"",donvi:a.donvi||""}},[location.search]),[f,g]=u.useState({status:!1,item:null}),v=()=>{g({...f,status:!1})},n=a=>{g({item:a,status:!0})},[i,d]=u.useState({status:!1,id_Delete:null}),p=a=>{d({status:!0,id_Delete:a})},M=()=>{d({...i,status:!1})},F=()=>{d({...i,status:!1})},{register:P,handleSubmit:W,control:A,resetField:S,setValue:L,watch:Ce,formState:{errors:ye}}=z({defaultValues:{tendoi:"",donvi:"",thutu:1,status:!0}});u.useEffect(()=>{(async()=>{try{s(!0);let x=await D.getDois(h);t(x.data),s(!1)}catch(x){x.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(r("/login"),s(!1),j.error(x.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"}))}})()},[h]);const I=async a=>{let x={...a,donvi:T,queryParams:h};s(!0);try{let b=await D.addDoi(x);t(b.data.dois),s(!1),S("tendoi"),L("thutu",Number(x.thutu)+1),S("status"),j.success(b.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"})}catch(b){j.error(b.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},Q=async a=>{let x={...a,donvi:T,queryParams:h};s(!0);try{let b=await D.editDoi(x);t(b.data.dois),s(!1),j.success(b.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"})}catch(b){j.error(b.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},K=async()=>{s(!0);try{let a=await D.deleteDoi(i.id_Delete,{...h});t(a.data.dois),s(!1),d({...i,status:!1}),j.success(a.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"})}catch(a){d({...i,status:!1}),j.error(a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},T=w(a=>a.authReducer.id_user);return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Quản lý đội nghiệp vụ, tổ công an cấp xã"})}),e.jsxs("form",{className:"mt-2 px-6 py-4 shadow-gray-400 shadow-md",onSubmit:W(I),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Tên đội nghiệp vụ, tổ công an cấp xã: "]}),e.jsx("input",{...P("tendoi",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...P("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái sử dụng:"}),e.jsx($,{name:"status",control:A,render:({field:{value:a,onChange:x}})=>e.jsx(H,{checked:a,onChange:x})})]})]}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(C,{type:"submit",color:"primary",variant:"contained",children:[e.jsx(q,{})," Thêm mới"]})})]}),e.jsxs("div",{className:"mt-6 shadow-black shadow-sm px-2",children:[e.jsx("p",{className:"text-center text-lg my-8 font-semibold mb-8",children:"Bảng danh sách đội nghiệp vụ, tổ công tác thuộc đơn vị"}),e.jsx(fe,{list:o,onClickOpenDialogDelete:p,onClickOpenDialogEdit:n})]}),e.jsx(ve,{open:f.status,item:f.item,onCloseDialogEdit:v,onSubmit:Q}),e.jsx(ee,{open:i.status,onCloseDialogDelete:F,onConfirmDelete:K,onCancelDelete:M})]})};export{Me as default};
