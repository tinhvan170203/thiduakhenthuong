import{r as f,j as e,s as L,c as I,d as Q,u as G,Q as j,N as J,h as U,e as X}from"./index-371a4e8f.js";import"./index.esm-a80e06b2.js";import{u as _,C as R}from"./index.esm-dbde89ce.js";import{d as $}from"./Add-b80d7046.js";import{a as Y,d as Z}from"./AutoAwesomeMotion-e68ec9ef.js";import{S as ee,D as se,a as te,d as ae,b as re}from"./Cancel-e1a5b8c1.js";import{I as y,B as E,P as le}from"./MenuItem-0a823130.js";import{S as z}from"./Switch-4739740e.js";import{D as ne}from"./DialogActions-8285de49.js";import{B as k}from"./Button-c29e04f7.js";import{D as oe}from"./DialogDelete-f47675d7.js";import{T as P,a as u,P as v,b as ie,c as de,d as ce,e as ue,f as he,g as T,h as w,i as O,j as B}from"./LastPage-410e0def.js";import{d as ge}from"./Edit-3f190fda.js";import{c as N}from"./capkhenthuong-f4ac5283.js";import"./createSvgIcon-b5eb2c40.js";import"./ButtonBase-3ca56fd5.js";const pe=f.forwardRef(function(r,o){return e.jsx(ee,{direction:"up",ref:o,...r})}),xe=L(y)({position:"absolute",right:"16px",top:"4px"});function me({open:l,item:r,onCloseDialogEdit:o,onSubmit:t}){const{register:d,handleSubmit:s,control:p,resetField:b,setValue:x,watch:C,formState:{errors:a}}=_({defaultValues:{capkhen:"",thutu:1,status:!0}});f.useEffect(()=>{r&&(x("capkhen",r.capkhen,{shouldValidate:!0}),x("thutu",r.thutu,{shouldValidate:!0}),x("status",r.status,{shouldValidate:!0}))},[r]);const i=async h=>{if(t){const c={...h,id_edit:r._id};await t(c),o()}};return e.jsx(e.Fragment,{children:e.jsxs(se,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(h,c)=>{c!=="backdropClick"&&o(h,c)},open:l,TransitionComponent:pe,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(te,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"#03528f",margin:"0px"},children:[e.jsx(Y,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa cấp khen thưởng"}),e.jsx(xe,{onClick:()=>o(),children:e.jsx(ae,{style:{color:"white"}})})]}),e.jsx(re,{children:e.jsx(E,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:s(i),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Cấp khen thưởng: "]}),e.jsx("input",{...d("capkhen",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...d("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái hiển thị:"}),e.jsx(R,{name:"status",control:p,render:({field:{value:h,onChange:c}})=>e.jsx(z,{checked:h,onChange:c})})]})]}),e.jsx(ne,{children:e.jsxs(k,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx($,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const fe=({row:l,page:r,rowsPerPage:o,index:t,onClickOpenDialogEdit:d,onClickOpenDialogDelete:s})=>(f.useState(null),e.jsxs(P,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(u,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:r*o+t}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:l.capkhen}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:l.thutu}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:l.status===!0?e.jsx(k,{color:"success",children:"Đang sử dụng"}):e.jsx(k,{color:"warning",children:"Không sử dụng"})}),e.jsxs(u,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[e.jsx(k,{variant:"contained",color:"info",size:"small",onClick:()=>d(l),children:e.jsx(ge,{style:{fontSize:"20px"}})}),e.jsx(k,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>s(l._id),children:e.jsx(Z,{style:{fontSize:"20px"}})})]})]},l._id));function H(l){const r=I(),{count:o,page:t,rowsPerPage:d,onPageChange:s}=l,p=a=>{s(a,0)},b=a=>{s(a,t-1)},x=a=>{s(a,t+1)},C=a=>{s(a,Math.max(0,Math.ceil(o/d)-1))};return e.jsxs(E,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(y,{onClick:p,disabled:t===0,"aria-label":"first page",children:r.direction==="rtl"?e.jsx(T,{}):e.jsx(w,{})}),e.jsx(y,{onClick:b,disabled:t===0,"aria-label":"previous page",children:r.direction==="rtl"?e.jsx(O,{}):e.jsx(B,{})}),e.jsx(y,{onClick:x,disabled:t>=Math.ceil(o/d)-1,"aria-label":"next page",children:r.direction==="rtl"?e.jsx(B,{}):e.jsx(O,{})}),e.jsx(y,{onClick:C,disabled:t>=Math.ceil(o/d)-1,"aria-label":"last page",children:r.direction==="rtl"?e.jsx(w,{}):e.jsx(T,{})})]})}H.propTypes={count:v.number.isRequired,onPageChange:v.func.isRequired,page:v.number.isRequired,rowsPerPage:v.number.isRequired};function be({list:l,onClickOpenDialogEdit:r,onClickOpenDialogDelete:o}){const[t,d]=f.useState(0),[s,p]=f.useState(10),b=t>0?Math.max(0,(1+t)*s-l.length):0,x=(a,i)=>{d(i)},C=a=>{p(parseInt(a.target.value,10)),d(0)};return e.jsxs(e.Fragment,{children:[e.jsx(ie,{component:le,children:e.jsxs(de,{"aria-label":"custom pagination table",children:[e.jsx(ce,{children:e.jsxs(P,{children:[e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Cấp khen thưởng"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Thứ tự"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(143 1 1)"},children:"Trạng thái sử dụng"}),e.jsx(u,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(ue,{children:[(s>0?l.slice(t*s,t*s+s):l).map((a,i)=>e.jsx(fe,{row:a,page:t,rowsPerPage:s,index:i+1,onClickOpenDialogEdit:r,onClickOpenDialogDelete:o},a._id)),b>0&&e.jsx(P,{style:{height:53*b},children:e.jsx(u,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(he,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:l.length,rowsPerPage:s,page:t,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:x,onRowsPerPageChange:C,ActionsComponent:H,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:i,to:h,count:c}){return`hiển thị ${i} đến ${h} bản ghi trong tổng số ${c!==-1?c:`more than ${h}`} bản ghi`}})})]})}const He=()=>{let l=Q(n=>n.authReducer.vaitro_theodoithidua);const r=G();if(l!=="Quản trị hệ thống")return j.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(J,{to:"/login",replace:!0});U();const[o,t]=f.useState([]),[d,s]=X(),[p,b]=f.useState({status:!1,item:null}),x=()=>{b({...p,status:!1})},C=n=>{b({item:n,status:!0})},[a,i]=f.useState({status:!1,id_Delete:null}),h=n=>{i({status:!0,id_Delete:n})},c=()=>{i({...a,status:!1})},q=()=>{i({...a,status:!1})},{register:D,handleSubmit:V,control:F,resetField:S,setValue:M,watch:je,formState:{errors:Ce}}=_({defaultValues:{capkhen:"",thutu:1,status:!0}});f.useEffect(()=>{(async()=>{try{s(!0);let g=await N.getCapkhenthuongs();t(g.data),s(!1)}catch(g){g.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(r("/login"),s(!1),j.error(g.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}))}})()},[]);const W=async n=>{let g={...n};s(!0);try{let m=await N.addCapkhenthuong(g);t(m.data.khois),s(!1),S("capkhen"),M("thutu",Number(n.thutu)+1),S("status"),j.success(m.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(m){j.error(m.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},A=async n=>{let g={...n};s(!0);try{let m=await N.editCapkhenthuong(g);t(m.data.khois),s(!1),j.success(m.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(m){j.error(m.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},K=async()=>{s(!0);try{let n=await N.deleteCapkhenthuong(a.id_Delete);t(n.data.khois),s(!1),i({...a,status:!1}),j.success(n.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(n){i({...a,status:!1}),j.error(n.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}};return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Quản lý các cấp khen thưởng"})}),e.jsxs("form",{className:"mt-2 px-6 py-4 shadow-gray-400 shadow-md",onSubmit:V(W),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Cấp khen thưởng: "]}),e.jsx("input",{...D("capkhen",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...D("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái sử dụng:"}),e.jsx(R,{name:"status",control:F,render:({field:{value:n,onChange:g}})=>e.jsx(z,{checked:n,onChange:g})})]})]}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(k,{type:"submit",color:"primary",variant:"contained",children:[e.jsx($,{})," Thêm mới"]})})]}),e.jsx("div",{className:"mt-6 px-2 shadow-black shadow-sm",children:e.jsx(be,{list:o,onClickOpenDialogDelete:h,onClickOpenDialogEdit:C})}),e.jsx(me,{open:p.status,item:p.item,onCloseDialogEdit:x,onSubmit:A}),e.jsx(oe,{open:a.status,onCloseDialogDelete:q,onConfirmDelete:K,onCancelDelete:c})]})};export{He as default};
