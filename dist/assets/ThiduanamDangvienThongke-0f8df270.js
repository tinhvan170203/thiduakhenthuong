import{r as t,j as e,c as xe,e as ue,u as ge,d as pe,Q as A}from"./index-371a4e8f.js";import"./index.esm-a80e06b2.js";import{u as be,C as fe}from"./index.esm-dbde89ce.js";import{C as ve,d as je}from"./FileDownload-e634af8f.js";import{S as N}from"./react-select.esm-68469137.js";import{c as Ne}from"./canboApi-98c0e799.js";import"./dayjs.min-9420a05b.js";import{t as W}from"./thongkeApi-1c610a45.js";import{d as ye}from"./BarChart-5733c919.js";import{D as Ce}from"./DoughnutChart-114a4d04.js";import{R as v}from"./RectangleChart-512fbbbc.js";import{P as y,b as Te,c as Se,d as ke,T as I,a as r,e as Pe,f as we,g as G,h as Q,i as J,j as U}from"./LastPage-410e0def.js";import{P as De,B as He,I as C}from"./MenuItem-0a823130.js";import{B as P}from"./Button-c29e04f7.js";import"./Link-24b18a5a.js";import"./createSvgIcon-b5eb2c40.js";import"./ButtonBase-3ca56fd5.js";import"./memoize-one.esm-8b357e52.js";import"./index-386ef5dd.js";import"./index-0fc6c329.js";function Z(m){const o=xe(),{count:x,page:n,rowsPerPage:u,onPageChange:h}=m,f=i=>{h(i,0)},l=i=>{h(i,n-1)},c=i=>{h(i,n+1)},g=i=>{h(i,Math.max(0,Math.ceil(x/u)-1))};return e.jsxs(He,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(C,{onClick:f,disabled:n===0,"aria-label":"first page",children:o.direction==="rtl"?e.jsx(G,{}):e.jsx(Q,{})}),e.jsx(C,{onClick:l,disabled:n===0,"aria-label":"previous page",children:o.direction==="rtl"?e.jsx(J,{}):e.jsx(U,{})}),e.jsx(C,{onClick:c,disabled:n>=Math.ceil(x/u)-1,"aria-label":"next page",children:o.direction==="rtl"?e.jsx(U,{}):e.jsx(J,{})}),e.jsx(C,{onClick:g,disabled:n>=Math.ceil(x/u)-1,"aria-label":"last page",children:o.direction==="rtl"?e.jsx(Q,{}):e.jsx(G,{})})]})}Z.propTypes={count:y.number.isRequired,onPageChange:y.func.isRequired,page:y.number.isRequired,rowsPerPage:y.number.isRequired};function _e({list:m}){const[o,x]=t.useState(0),[n,u]=t.useState(10);o>0&&Math.max(0,(1+o)*n-m.length);const h=(l,c)=>{x(c)},f=l=>{u(parseInt(l.target.value,10)),x(0)};return e.jsxs(e.Fragment,{children:[e.jsx(Te,{component:De,children:e.jsxs(Se,{"aria-label":"custom pagination table",children:[e.jsx(ke,{children:e.jsxs(I,{children:[e.jsx(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Họ tên"}),e.jsx(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Đơn vị công tác tính đến hết năm"}),e.jsx(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Kết quả xếp loại đảng viên"}),e.jsx(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Ghi chú"}),e.jsx(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(143 1 1)"},children:"Chi tiết"})]})}),e.jsx(Pe,{children:(n>0?m.slice(o*n,o*n+n):m).map((l,c)=>e.jsxs(I,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(r,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:o*n+c+1}),e.jsx(r,{className:"border-r border-slate-300",align:"left",children:e.jsx("span",{className:"font-bold",children:l.hoten})}),e.jsx(r,{className:"border-r border-slate-300",align:"left",children:e.jsx("span",{children:l.donvidangcongtac})}),e.jsx(r,{className:"border-r border-slate-300",align:"left",children:l.result}),e.jsx(r,{className:"border-r border-slate-300",align:"left",children:l.ghichu}),e.jsx(r,{className:"border-r border-slate-300",align:"right",children:e.jsx(P,{variant:"contained",color:"info",size:"small",onClick:()=>window.open(`/dashboard/chi-tiet-ca-nhan/${l.id_canhan}`,"_blank","noreferrer"),children:"Trang cá nhân"})})]},l._id))})]})}),e.jsx("div",{children:e.jsx(we,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:m.length,rowsPerPage:n,page:o,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:h,onRowsPerPageChange:f,ActionsComponent:Z,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:c,to:g,count:i}){return`hiển thị ${c} đến ${g} bản ghi trong tổng số ${i!==-1?i:`more than ${g}`} bản ghi`}})})]})}let Be=[{label:"STT",key:"stt"},{label:"Họ tên",key:"hoten"},{label:"Đơn vị đang công tác",key:"donvidangcongtac"},{label:"Kết quả xếp loại đảng viên",key:"xeploai"},{label:"Ghi chú",key:"ghichu"}];const sa=()=>{const[m,o]=t.useState(0),[x,n]=t.useState(0),[u,h]=ue(),[f,l]=t.useState([]),[c,g]=t.useState({label:"",value:""});t.useState(!1);const[i,w]=t.useState([]),[j,D]=t.useState(0),[ee,H]=t.useState(""),[ae,te]=t.useState([]),[_,se]=t.useState([]),[B,R]=t.useState([]),[T,V]=t.useState(""),[$,ne]=t.useState(0),[q,le]=t.useState(0),[L,oe]=t.useState(0),[z,ie]=t.useState(0),[K,re]=t.useState(0),[S,E]=t.useState({label:"Tất cả",value:""}),[ce,de]=t.useState([]),[k,M]=t.useState({label:"Tất cả",value:""}),O=ge(),{register:Re,handleSubmit:Ve,control:he,resetField:$e,setValue:Y,watch:F,formState:{errors:qe}}=be({defaultValues:{donvi:{label:"Tất cả",value:""}}}),X=pe(a=>a.authReducer.vaitro_theodoithidua);t.useEffect(()=>{(async()=>{try{let s=await Ne.fetchYearMonth(),p=await W.getDonviDois({vaitro:X});l(p.data.data_donvi),Y("tunam",s.data.year-1),Y("dennam",s.data.year-1),D(s.data.year),H(s.data.year);let d=[];for(let b=s.data.year;b>=2022;b--)d.push({label:b,value:b});te(d),o(s.data.year),n(s.data.year)}catch(s){s.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(O("/login"),A.error(s.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(s.message)}})()},[]);const me=async()=>{try{h(!0);let a=await W.getXeploaidangvienNam({vaitro:X,nam:j,donvi:F("donvi").value});H(j),g(F("donvi")),se(a.data.data),R(a.data.data),de([{label:"Tất cả",value:""}].concat(a.data.list_doi_option)),le(a.data.total_khtnv),oe(a.data.total_htnv),ie(a.data.total_httnv),re(a.data.total_htxsnv),ne(a.data.total_not_value),V(""),M({label:"Tất cả",value:""}),E({label:"Tất cả",value:""}),w(a.data.data.map((s,p)=>({stt:p+1,hoten:s.hoten,donvidangcongtac:s.donvidangcongtac,xeploai:s.result,ghichu:s.ghichu}))),h(!1)}catch(a){a.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(O("/login"),A.error(a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(a.message)}};return t.useEffect(()=>{let a=[..._];if(a.length>0){const s=setTimeout(()=>{let p=a.filter(d=>d.hoten.toLowerCase().includes(T.toLowerCase())&&d.id_donvidangcongtac.includes(k.value)&&d.result.includes(S.value));R(p),w(p.map((d,b)=>({stt:b+1,hoten:d.hoten,donvidangcongtac:d.donvidangcongtac,xeploai:d.result,ghichu:d.ghichu})))},500);return()=>clearTimeout(s)}},[T,k,S]),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Thống kê, theo dõi kết quả xếp loại đảng viên của đảng viên công tác tại đơn vị"})}),e.jsxs("div",{className:"my-2 mt-4 flex justify-center shadow-gray-400 shadow-md p-4 rounded-sm",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex px-1",children:[e.jsx("label",{className:"font-semibold",children:"Năm: "}),e.jsx(N,{value:{label:j,value:j},required:!0,name:"nam",options:ae,className:"basic-multi-select my-4",classNamePrefix:"select",onChange:a=>D(a.value)})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex px-1",children:[e.jsx("label",{className:"font-semibold",children:"Đơn vị công tác: "}),e.jsx(fe,{control:he,name:"donvi",render:({field:a})=>e.jsx(N,{options:f,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Tất cả",...a})})]}),e.jsx("div",{className:"flex-col px-1 flex items-end justify-center",children:e.jsxs(P,{variant:"contained",onClick:()=>me(),style:{width:"200px"},color:"primary",children:[e.jsx(ye,{})," Thống kê dữ liệu"]})})]}),e.jsx("p",{className:"text-red-600 font-medium text-center mt-8",children:"Biểu đồ kết quả xếp loại đảng viên hiện nay đang công tác"}),e.jsx("div",{className:"flex mb-8 mt-2 justify-center items-center shadow-lg shadow-slate-300 py-8",children:e.jsx("div",{className:"md:basis-1/4",children:e.jsx(Ce,{dataHTNV:L,dataHTTNV:z,dataHTXSNV:K,dataKHTNV:q,dataNotValue:$,total:_.length})})}),e.jsxs("div",{className:"shadow-lg  mb-8 pb-8 shadow-slate-300 ",children:[e.jsxs("div",{className:"flex mt-4",children:[e.jsx(v,{text:"Hoàn thành xuất sắc nhiệm vụ",number:K,color:"bg-red-600"}),e.jsx(v,{text:"Hoàn thành tốt nhiệm vụ",number:z,color:"bg-cyan-600"}),e.jsx(v,{text:"Hoàn thành nhiệm vụ",number:L,color:"bg-blue-600"}),e.jsx(v,{text:"Không hoàn thành nhiệm vụ",number:q,color:"bg-pink-600"}),e.jsx(v,{text:"Chưa có dữ liệu",number:$,color:"bg-yellow-600"})]}),e.jsx("p",{className:"text-blue-600 font-medium text-center mt-2",children:"Thống kê số lượt xếp loại đảng viên"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-center text-lg mt-8 font-semibold",children:["Bảng xếp loại đảng viên đang công tác năm ",ee]}),e.jsx("h3",{className:"text-center mt-4 text-blue-600 text-xl font-bold"}),e.jsxs("h3",{className:"text-center mb-4 text-lg text-black",children:[" ",c==null?void 0:c.label]}),e.jsxs("div",{className:"flex space-x-2 md:flex-row justify-end items-center",children:[e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx("input",{value:T,placeholder:"Tìm kiếm đảng viên",name:"search",onChange:a=>V(a.target.value),type:"text",className:`outline-none my-4 border rounded-md px-2 py-[6px] border-neutral-300\r
                              focus:border-blue-500 focus:border-2`})}),e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx(N,{value:k,options:ce,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Đơn vị công tác",onChange:a=>M(a)})}),e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx(N,{value:S,options:[{label:"Tất cả",value:""},{label:"Hoàn thành xuất sắc nhiệm vụ",value:"Hoàn thành xuất sắc nhiệm vụ"},{label:"Hoàn thành tốt nhiệm vụ",value:"Hoàn thành tốt nhiệm vụ"},{label:"Hoàn thành nhiệm vụ",value:"Hoàn thành nhiệm vụ"},{label:"Không hoàn thành nhiệm vụ",value:"Không hoàn thành nhiệm vụ"},{label:"Chưa có dữ liệu",value:"Chưa có dữ liệu"}],className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Kết quả xếp loại",onChange:a=>E(a)})})]}),e.jsxs("div",{className:"pb-8",children:[e.jsxs("h3",{className:"text-end my-4",children:["Tổng số: ",e.jsx("span",{className:"text-xl font-bold text-red-600",children:B.length})," đảng viên"]}),e.jsx("div",{className:"mt-4 text-end mb-2 md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(P,{variant:"contained",color:"success",size:"small",children:e.jsxs(ve,{data:i,headers:Be,filename:"xeploaidangvien",children:[e.jsx(je,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsx(_e,{list:B})]})]})]})};export{sa as default};
