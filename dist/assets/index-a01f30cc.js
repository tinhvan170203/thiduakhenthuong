import{r as f,j as e,s as L,c as I,d as B,u as Q,Q as j,N as G,h as J,e as U}from"./index-469ebc4a.js";import"./index.esm-a80e06b2.js";import{u as z,C as T}from"./index.esm-e24acc70.js";import{d as E}from"./Add-c692c54c.js";import{a as X,d as Y}from"./AutoAwesomeMotion-01db5c5f.js";import{S as Z,D as ee,a as se,d as te,b as ae}from"./Cancel-be6c3443.js";import{I as y,B as A,P as le}from"./MenuItem-22e0308b.js";import{S as P}from"./Switch-a6bd2fbd.js";import{D as re}from"./DialogActions-425572d2.js";import{B as C}from"./Button-e3d685a6.js";import{D as oe}from"./DialogDelete-28d67f98.js";import{k as v}from"./khoiApi-b720f5dd.js";import{T as S,a as c,P as N,b as ne,c as ie,d as de,e as ce,f as he,g as _,h as R,i as K,j as $}from"./LastPage-511a91a0.js";import{d as ue}from"./Edit-1cb268c9.js";import"./createSvgIcon-e7baeffd.js";import"./ButtonBase-ea83d2d9.js";const xe=f.forwardRef(function(r,n){return e.jsx(Z,{direction:"up",ref:n,...r})}),ge=L(y)({position:"absolute",right:"16px",top:"4px"});function me({open:o,item:r,onCloseDialogEdit:n,onSubmit:t}){const{register:h,handleSubmit:s,control:g,resetField:b,setValue:m,watch:k,formState:{errors:a}}=z({defaultValues:{tenkhoi:"",thutu:1,status:!0,thuocCAT:!0}});f.useEffect(()=>{r&&(m("tenkhoi",r.tenkhoi,{shouldValidate:!0}),m("thutu",r.thutu,{shouldValidate:!0}),m("status",r.status,{shouldValidate:!0}),m("thuocCAT",r.thuocCAT,{shouldValidate:!0}))},[r]);const i=async u=>{if(t){const d={...u,id_edit:r._id};await t(d),n()}};return e.jsx(e.Fragment,{children:e.jsxs(ee,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(u,d)=>{d!=="backdropClick"&&n(u,d)},open:o,TransitionComponent:xe,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(se,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"#03528f",margin:"0px"},children:[e.jsx(X,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa khối, hệ, lực lượng"}),e.jsx(ge,{onClick:()=>n(),children:e.jsx(te,{style:{color:"white"}})})]}),e.jsx(ae,{children:e.jsx(A,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:s(i),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Khối, hệ, lực lượng: "]}),e.jsx("input",{...h("tenkhoi",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...h("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái hiển thị:"}),e.jsx(T,{name:"status",control:g,render:({field:{value:u,onChange:d}})=>e.jsx(P,{checked:u,onChange:d})})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Thuộc Công an tỉnh:"}),e.jsx(T,{name:"thuocCAT",control:g,render:({field:{value:u,onChange:d}})=>e.jsx(P,{checked:u,onChange:d})})]})]}),e.jsx(re,{children:e.jsxs(C,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx(E,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const pe=({row:o,page:r,rowsPerPage:n,index:t,onClickOpenDialogEdit:h,onClickOpenDialogDelete:s})=>(f.useState(null),e.jsxs(S,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(c,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:r*n+t}),e.jsx(c,{className:"border-r border-slate-300",align:"left",children:o.tenkhoi}),e.jsx(c,{className:"border-r border-slate-300",align:"left",children:o.thutu}),e.jsx(c,{className:"border-r border-slate-300",align:"left",children:o.status===!0?e.jsx(C,{color:"success",children:"Đang hiển thị"}):e.jsx(C,{color:"warning",children:"Không hiển thị"})}),e.jsx(c,{className:"border-r border-slate-300",align:"left",children:o.thuocCAT===!0?e.jsx(C,{color:"success",children:"Có"}):e.jsx(C,{color:"warning",children:"Không"})}),e.jsxs(c,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[e.jsx(C,{variant:"contained",color:"info",size:"small",onClick:()=>h(o),children:e.jsx(ue,{style:{fontSize:"20px"}})}),e.jsx(C,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>s(o._id),children:e.jsx(Y,{style:{fontSize:"20px"}})})]})]},o._id));function H(o){const r=I(),{count:n,page:t,rowsPerPage:h,onPageChange:s}=o,g=a=>{s(a,0)},b=a=>{s(a,t-1)},m=a=>{s(a,t+1)},k=a=>{s(a,Math.max(0,Math.ceil(n/h)-1))};return e.jsxs(A,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(y,{onClick:g,disabled:t===0,"aria-label":"first page",children:r.direction==="rtl"?e.jsx(_,{}):e.jsx(R,{})}),e.jsx(y,{onClick:b,disabled:t===0,"aria-label":"previous page",children:r.direction==="rtl"?e.jsx(K,{}):e.jsx($,{})}),e.jsx(y,{onClick:m,disabled:t>=Math.ceil(n/h)-1,"aria-label":"next page",children:r.direction==="rtl"?e.jsx($,{}):e.jsx(K,{})}),e.jsx(y,{onClick:k,disabled:t>=Math.ceil(n/h)-1,"aria-label":"last page",children:r.direction==="rtl"?e.jsx(R,{}):e.jsx(_,{})})]})}H.propTypes={count:N.number.isRequired,onPageChange:N.func.isRequired,page:N.number.isRequired,rowsPerPage:N.number.isRequired};function fe({list:o,onClickOpenDialogEdit:r,onClickOpenDialogDelete:n}){const[t,h]=f.useState(0),[s,g]=f.useState(10),b=t>0?Math.max(0,(1+t)*s-o.length):0,m=(a,i)=>{h(i)},k=a=>{g(parseInt(a.target.value,10)),h(0)};return e.jsxs(e.Fragment,{children:[e.jsx(ne,{component:le,children:e.jsxs(ie,{"aria-label":"custom pagination table",children:[e.jsx(de,{children:e.jsxs(S,{children:[e.jsx(c,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(c,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Khối, hệ, lực lượng"}),e.jsx(c,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Thứ tự"}),e.jsx(c,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(143 1 1)"},children:"Trạng thái hiển thị"}),e.jsx(c,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(143 1 1)"},children:"Trực thuộc Công an tỉnh"}),e.jsx(c,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(ce,{children:[(s>0?o.slice(t*s,t*s+s):o).map((a,i)=>e.jsx(pe,{row:a,page:t,rowsPerPage:s,index:i+1,onClickOpenDialogEdit:r,onClickOpenDialogDelete:n},a._id)),b>0&&e.jsx(S,{style:{height:53*b},children:e.jsx(c,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(he,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:o.length,rowsPerPage:s,page:t,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:m,onRowsPerPageChange:k,ActionsComponent:H,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:i,to:u,count:d}){return`hiển thị ${i} đến ${u} bản ghi trong tổng số ${d!==-1?d:`more than ${u}`} bản ghi`}})})]})}const ze=()=>{let o=B(l=>l.authReducer.vaitro_theodoithidua);const r=Q();if(o!=="Quản trị hệ thống")return j.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(G,{to:"/login",replace:!0});J();const[n,t]=f.useState([]),[h,s]=U(),[g,b]=f.useState({status:!1,item:null}),m=()=>{b({...g,status:!1})},k=l=>{b({item:l,status:!0})},[a,i]=f.useState({status:!1,id_Delete:null}),u=l=>{i({status:!0,id_Delete:l})},d=()=>{i({...a,status:!1})},q=()=>{i({...a,status:!1})},{register:w,handleSubmit:V,control:O,resetField:D,watch:be,formState:{errors:je}}=z({defaultValues:{tenkhoi:"",thutu:1,status:!0}});f.useEffect(()=>{(async()=>{try{s(!0);let x=await v.getKhois();t(x.data),setTimeout(()=>{s(!1)},400)}catch(x){x.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(r("/login"),s(!1),j.error(x.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}))}})()},[]);const F=async l=>{let x={...l};s(!0);try{let p=await v.addKhoi(x);t(p.data.khois),setTimeout(()=>{s(!1)},400),D("tenkhoi"),D("thutu"),D("status"),j.success(p.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(p){j.error(p.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},M=async l=>{let x={...l};s(!0);try{let p=await v.editKhoi(x);t(p.data.khois),setTimeout(()=>{s(!1)},400),j.success(p.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(p){j.error(p.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},W=async()=>{s(!0);try{let l=await v.deleteKhoi(a.id_Delete);t(l.data.khois),setTimeout(()=>{s(!1)},400),i({...a,status:!1}),j.success(l.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(l){i({...a,status:!1}),j.error(l.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}};return B(l=>l.authReducer.roles_theodoithidua),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Quản lý khối, hệ, lực lượng"})}),e.jsxs("form",{className:"mt-2 mx-2 shadow-md py-4 px-2 shadow-gray-400",onSubmit:V(F),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Khối, hệ, lực lượng: "]}),e.jsx("input",{...w("tenkhoi",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...w("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái sử dụng:"}),e.jsx(T,{name:"status",control:O,render:({field:{value:l,onChange:x}})=>e.jsx(P,{checked:l,onChange:x})})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Thuộc Công an tỉnh:"}),e.jsx(T,{name:"thuocCAT",control:O,render:({field:{value:l,onChange:x}})=>e.jsx(P,{checked:l,onChange:x})})]})]}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(C,{type:"submit",color:"primary",variant:"contained",children:[e.jsx(E,{})," Thêm mới"]})})]}),e.jsx("div",{className:"mt-6 mx-2 shadow-md shadow-gray-600",children:e.jsx(fe,{list:n,onClickOpenDialogDelete:u,onClickOpenDialogEdit:k})}),e.jsx(me,{open:g.status,item:g.item,onCloseDialogEdit:m,onSubmit:M}),e.jsx(oe,{open:a.status,onCloseDialogDelete:q,onConfirmDelete:W,onCancelDelete:d})]})};export{ze as default};
