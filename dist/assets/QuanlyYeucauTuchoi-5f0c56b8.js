import{r as h,d as I,j as e,c as q,u as Q,Q as T,N as F,e as V}from"./index-371a4e8f.js";import{T as _,a as g,P as N,b as W,c as X,d as G,e as Y,f as J,g as L,h as O,i as D,j as z}from"./LastPage-410e0def.js";import"./dayjs.min-9420a05b.js";import{P as K,B as U,I as B}from"./MenuItem-0a823130.js";import{c as E}from"./canboApi-98c0e799.js";import"./index.esm-a80e06b2.js";import{B as Z}from"./Button-c29e04f7.js";import"./createSvgIcon-b5eb2c40.js";import"./ButtonBase-3ca56fd5.js";const ee=({row:a,page:p,rowsPerPage:m,index:s,onChangeCheckBox:i,recevices:o})=>{h.useState(null),I(f=>f.authReducer.roles_theodoithidua);const[u,b]=h.useState(!1);h.useEffect(()=>{if(a._id){let f=o.findIndex(n=>n.value.toString()===a._id.toString());if(f===-1)return;b(o[f].isChecked)}},[o]);const x=f=>{const{value:n,checked:C}=f.target;i({value:n,checked:C})};return e.jsxs(_,{children:[e.jsx(g,{className:"border-r border-slate-300",align:"left",children:e.jsx("input",{className:"w-4 h-4",type:"checkbox",onChange:x,checked:u,value:a._id})}),e.jsx(g,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:p*m+s}),e.jsx(g,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a.hoten}),e.jsx(g,{className:"border-r border-slate-300",align:"left",children:a.chucvu[0].chucvu.chucvu}),e.jsx(g,{className:"border-r border-slate-300",align:"left",children:e.jsx("p",{className:"truncate",children:a.yeucauChuyencongtac.target.tenhienthi})}),e.jsx(g,{className:"border-r border-slate-300",align:"left",children:a.yeucauChuyencongtac.ghichu_target})]},a._id)};function $(a){const p=q(),{count:m,page:s,rowsPerPage:i,onPageChange:o}=a,u=n=>{o(n,0)},b=n=>{o(n,s-1)},x=n=>{o(n,s+1)},f=n=>{o(n,Math.max(0,Math.ceil(m/i)-1))};return e.jsxs(U,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(B,{onClick:u,disabled:s===0,"aria-label":"first page",children:p.direction==="rtl"?e.jsx(L,{}):e.jsx(O,{})}),e.jsx(B,{onClick:b,disabled:s===0,"aria-label":"previous page",children:p.direction==="rtl"?e.jsx(D,{}):e.jsx(z,{})}),e.jsx(B,{onClick:x,disabled:s>=Math.ceil(m/i)-1,"aria-label":"next page",children:p.direction==="rtl"?e.jsx(z,{}):e.jsx(D,{})}),e.jsx(B,{onClick:f,disabled:s>=Math.ceil(m/i)-1,"aria-label":"last page",children:p.direction==="rtl"?e.jsx(O,{}):e.jsx(L,{})})]})}$.propTypes={count:N.number.isRequired,onPageChange:N.func.isRequired,page:N.number.isRequired,rowsPerPage:N.number.isRequired};function ae({list:a,onClickOpenDialogDelete:p,onClickOpenDialogEdit:m,onChangeCheckList:s}){const[i,o]=h.useState(0),[u,b]=h.useState(10),x=i>0?Math.max(0,(1+i)*u-a.length):0,f=(t,c)=>{o(c)},n=t=>{b(parseInt(t.target.value,10)),o(0)},[C,y]=h.useState([]),[r,l]=h.useState([]);h.useEffect(()=>{l(a);let t=a.map(c=>({value:c._id,isChecked:!1}));y(t)},[a]);const P=t=>{const{name:c,value:j,checked:d}=t.target;let k=[...r],v=[...C];k=k.map(R=>R._id);for(let R of k){let H=v.findIndex(M=>M.value.toString()===R.toString());v[H].isChecked=d}y(v),s(v)},S=t=>{let{value:c,checked:j}=t,d=[...C],k=d.findIndex(v=>v.value===c);d[k].isChecked=j,y(d),s(d)},[A,w]=h.useState(!1);return h.useEffect(()=>{let t=[...r],c=[...C];t=t.map(d=>d._id);let j=0;for(let d of t){let k=c.findIndex(v=>v.value.toString()===d.toString());if(k===-1)return;c[k].isChecked===!0&&(j+=1)}t.length===j?w(!0):w(!1)},[r,S]),e.jsxs(e.Fragment,{children:[e.jsx(W,{component:K,style:{overflowX:"scroll"},children:e.jsxs(X,{"aria-label":"custom pagination table",children:[e.jsx(G,{children:e.jsxs(_,{children:[e.jsx(g,{align:"left",style:{fontSize:"14px"},className:"border-r border-slate-300",children:e.jsx("input",{type:"checkbox",name:"all",value:"",onChange:P,checked:A,className:"w-4 h-4"})}),e.jsx(g,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(g,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Họ tên"}),e.jsx(g,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Chức vụ"}),e.jsx(g,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Đơn vị từ chối tiếp nhận"}),e.jsx(g,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Ghi chú của đơn vị từ chối"})]})}),e.jsxs(Y,{children:[(u>0?a.slice(i*u,i*u+u):a).map((t,c)=>e.jsx(ee,{row:t,page:i,rowsPerPage:u,index:c+1,onClickOpenDialogEdit:m,onClickOpenDialogDelete:p,onChangeCheckBox:S,recevices:C},t._id)),x>0&&e.jsx(_,{style:{height:53*x},children:e.jsx(g,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(J,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:a.length,rowsPerPage:u,page:i,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:f,onRowsPerPageChange:n,ActionsComponent:$,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:c,to:j,count:d}){return`hiển thị ${c} đến ${j} bản ghi trong tổng số ${d!==-1?d:`more than ${j}`} bản ghi`}})})]})}const he=()=>{let a=I(r=>r.authReducer.vaitro_theodoithidua);const p=Q();if(a!=="Quản trị thông thường")return T.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(F,{to:"/login",replace:!0});const[m,s,i,o,u]=V(),[b,x]=h.useState([]),[f,n]=h.useState([]);h.useEffect(()=>{(async()=>{try{let l=await E.fetchListBiTuchoi();x(l.data)}catch(l){console.log(l.message)}})()},[]);const C=r=>{n(r)},y=async()=>{let r=[...f];if(r=r.filter(l=>l.isChecked===!0).map(l=>l.value),r.length===0){alert("Vui lòng tích chọn cán bộ, chiến sĩ xác nhận thu hồi yêu cầu luân chuyển");return}s(!0);try{let l=await E.backtoDonvi({array:r});o();let P=[...b];P=P.filter(S=>r.includes(S._id)===!1),x(P),s(!1),T.success(l.data.message,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"})}catch(l){l.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(p("/login"),s(!1),T.error(l.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"})),T.error(l.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),s(!1)}};return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Quản lý yêu cầu điều chuyển cán bộ bị từ chối"})}),e.jsx("div",{className:"flex items-center space-x-2 justify-end my-4",children:e.jsx(Z,{variant:"contained",color:"success",size:"small",onClick:()=>y(),children:"Xác nhận thu hồi về đơn vị"})}),e.jsx("div",{className:"mt-6 mx-0 shadow-md shadow-gray-500 rounded-md",children:e.jsx(ae,{list:b,onClickOpenDialogEdit:()=>{},onClickOpenDialogDelete:()=>{},onChangeCheckList:C})})]})};export{he as default};
