import{j as e,r as c,c as F,d as Y,e as M}from"./index-371a4e8f.js";import{S as w}from"./react-select.esm-68469137.js";import{u as q,C as L}from"./index.esm-dbde89ce.js";import{c as V}from"./canboApi-98c0e799.js";import{t as C}from"./thongkeApi-1c610a45.js";import{d as A}from"./BarChart-5733c919.js";import{T as y,a as p,P as v,b as E,c as H,d as z,e as I,f as W,g as D,h as S,i as B,j as R}from"./LastPage-410e0def.js";import{P as X,B as K,I as P}from"./MenuItem-0a823130.js";import{B as G}from"./Button-c29e04f7.js";import"./memoize-one.esm-8b357e52.js";import"./ButtonBase-3ca56fd5.js";import"./createSvgIcon-b5eb2c40.js";const J=({row:i,page:a,rowsPerPage:r,index:s})=>e.jsxs(y,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(p,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a*r+s}),e.jsx(p,{className:"border-r border-slate-300",align:"left",children:e.jsx("span",{className:"font-bold",children:i.tapthe})}),e.jsx(p,{className:"border-r border-slate-300",align:"left",children:e.jsx("span",{children:i.noidung})})]},i._id);function O(i){const a=F(),{count:r,page:s,rowsPerPage:h,onPageChange:d}=i,m=n=>{d(n,0)},x=n=>{d(n,s-1)},o=n=>{d(n,s+1)},g=n=>{d(n,Math.max(0,Math.ceil(r/h)-1))};return e.jsxs(K,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(P,{onClick:m,disabled:s===0,"aria-label":"first page",children:a.direction==="rtl"?e.jsx(D,{}):e.jsx(S,{})}),e.jsx(P,{onClick:x,disabled:s===0,"aria-label":"previous page",children:a.direction==="rtl"?e.jsx(B,{}):e.jsx(R,{})}),e.jsx(P,{onClick:o,disabled:s>=Math.ceil(r/h)-1,"aria-label":"next page",children:a.direction==="rtl"?e.jsx(R,{}):e.jsx(B,{})}),e.jsx(P,{onClick:g,disabled:s>=Math.ceil(r/h)-1,"aria-label":"last page",children:a.direction==="rtl"?e.jsx(S,{}):e.jsx(D,{})})]})}O.propTypes={count:v.number.isRequired,onPageChange:v.func.isRequired,page:v.number.isRequired,rowsPerPage:v.number.isRequired};function Q({list:i}){const[a,r]=c.useState(0),[s,h]=c.useState(10),d=a>0?Math.max(0,(1+a)*s-i.length):0,m=(o,g)=>{r(g)},x=o=>{h(parseInt(o.target.value,10)),r(0)};return e.jsxs(e.Fragment,{children:[e.jsx(E,{component:X,children:e.jsxs(H,{"aria-label":"custom pagination table",children:[e.jsx(z,{children:e.jsxs(y,{children:[e.jsx(p,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(p,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Tập thể đạt danh hiệu"}),e.jsx(p,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Nội dung và ghi chú"})]})}),e.jsxs(I,{children:[(s>0?i.slice(a*s,a*s+s):i).map((o,g)=>e.jsx(J,{row:o,page:a,rowsPerPage:s,index:g+1},o._id)),d>0&&e.jsx(y,{style:{height:53*d},children:e.jsx(p,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(W,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:i.length,rowsPerPage:s,page:a,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:m,onRowsPerPageChange:x,ActionsComponent:O,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:g,to:n,count:f}){return`hiển thị ${g} đến ${n} bản ghi trong tổng số ${f!==-1?f:`more than ${n}`} bản ghi`}})})]})}const xe=()=>{const i=Y(t=>t.authReducer.vaitro_theodoithidua),[a,r]=c.useState(0),[s,h]=c.useState(""),[d,m]=c.useState([]),[x,o]=c.useState([]),[g,n]=c.useState([]),[f,k]=c.useState([]),[U,u]=M(),{register:Z,handleSubmit:ee,control:_,resetField:ae,setValue:se,watch:N,formState:{errors:te}}=q({defaultValues:{cap:{label:"Cấp Phòng",value:"Cấp Phòng"}}});c.useEffect(()=>{(async()=>{try{let l=await V.fetchYearMonth(),b=await C.getDonviDois({vaitro:i});m(b.data.data_donvi),r(l.data.year),h(l.data.year);let T=[];for(let j=l.data.year;j>=2022;j--)T.push({label:j,value:j});o(T)}catch(l){l.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(navigate("/login"),toast.error(l.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(l.message)}})()},[]);const $=async()=>{u(!0);try{let t=await C.getDanhhieuThiduaNam({nam:a,cap:N("cap").value});h(a),n(t.data),k(t.data),u(!1)}catch(t){t.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(navigate("/login"),toast.error(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),u(!1)),console.log(t.message),u(!1)}};return c.useEffect(()=>{(async()=>{u(!0);try{let l=new Date().getFullYear(),b=await C.getDanhhieuThiduaNam({nam:l,cap:N("cap").value});h(a),n(b.data),k(b.data),u(!1)}catch(l){l.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(navigate("/login"),toast.error(l.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),u(!1)),console.log(l.message),u(!1)}})()},[]),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Thống kê, theo dõi kết quả danh hiệu thi đua năm của các đơn vị"})}),e.jsxs("div",{className:"my-2 mt-4 flex justify-center shadow-gray-400 shadow-md p-4 rounded-sm",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex px-1",children:[e.jsx("label",{className:"font-semibold",children:"Năm: "}),e.jsx(w,{value:{label:a,value:a},required:!0,name:"nam",options:x,className:"basic-multi-select my-4",classNamePrefix:"select",onChange:t=>r(t.value)})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex px-1",children:[e.jsx("label",{className:"font-semibold",children:"Khối đơn vị: "}),e.jsx(L,{control:_,name:"cap",render:({field:t})=>e.jsx(w,{options:[{label:"Cấp Phòng",value:"Cấp Phòng"},{label:"Cấp Xã",value:"Cấp Xã"}],className:"basic-multi-select my-3 p-1",classNamePrefix:"select",...t})})]}),e.jsx("div",{className:"flex-col px-1 flex items-end justify-center",children:e.jsxs(G,{variant:"contained",onClick:()=>$(),style:{width:"200px"},color:"primary",children:[e.jsx(A,{})," Thống kê dữ liệu"]})})]}),e.jsxs("div",{className:"mt-2 shadow-md shadow-gray-500 rounded-md",children:[e.jsxs("p",{className:"text-center text-lg mt-8 font-semibold",children:["Danh sách thống kê danh hiệu thi đua năm ",s," của các tập thể"]}),e.jsxs("span",{className:"font-semibold p-4",children:["Tổng số: ",e.jsx("span",{className:"text-2xl text-red-600 font-semibold",children:f.length})," tập thể đạt danh hiệu thi đua năm ",s]}),e.jsx("div",{className:"px-2 mt-4 ",children:e.jsx(Q,{list:f})})]})]})};export{xe as default};
