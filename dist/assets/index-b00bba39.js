import{r as f,j as e,s as I,c as Q,d as T,u as G,Q as j,N as J,e as U}from"./index-371a4e8f.js";import"./index.esm-a80e06b2.js";import{u as H,C as R}from"./index.esm-dbde89ce.js";import{d as $}from"./Add-b80d7046.js";import{a as X,d as Y}from"./AutoAwesomeMotion-e68ec9ef.js";import{S as Z,D as ee,a as se,d as te,b as ae}from"./Cancel-e1a5b8c1.js";import{I as y,B as E,P as re}from"./MenuItem-0a823130.js";import{S as z}from"./Switch-4739740e.js";import{D as ne}from"./DialogActions-8285de49.js";import{B as C}from"./Button-c29e04f7.js";import{D as le}from"./DialogDelete-f47675d7.js";import{T as P,a as h,P as v,b as oe,c as ie,d as de,e as ce,f as he,g as w,h as O,i as B,j as _}from"./LastPage-410e0def.js";import{d as ue}from"./Edit-3f190fda.js";import{h as N}from"./hinhthuckhen-1ce2f73f.js";import"./createSvgIcon-b5eb2c40.js";import"./ButtonBase-3ca56fd5.js";const ge=f.forwardRef(function(n,o){return e.jsx(Z,{direction:"up",ref:o,...n})}),xe=I(y)({position:"absolute",right:"16px",top:"4px"});function pe({open:l,item:n,onCloseDialogEdit:o,onSubmit:t}){const{register:d,handleSubmit:s,control:x,resetField:b,setValue:p,watch:k,formState:{errors:a}}=H({defaultValues:{hinhthuckhen:"",thutu:1,status:!0}});f.useEffect(()=>{n&&(p("hinhthuckhen",n.hinhthuckhen,{shouldValidate:!0}),p("thutu",n.thutu,{shouldValidate:!0}),p("status",n.status,{shouldValidate:!0}))},[n]);const i=async u=>{if(t){const c={...u,id_edit:n._id};await t(c),o()}};return e.jsx(e.Fragment,{children:e.jsxs(ee,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(u,c)=>{c!=="backdropClick"&&o(u,c)},open:l,TransitionComponent:ge,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(se,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"#03528f",margin:"0px"},children:[e.jsx(X,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa hình thức khen thưởng"}),e.jsx(xe,{onClick:()=>o(),children:e.jsx(te,{style:{color:"white"}})})]}),e.jsx(ae,{children:e.jsx(E,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:s(i),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Hình thức khen thưởng: "]}),e.jsx("input",{...d("hinhthuckhen",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...d("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái hiển thị:"}),e.jsx(R,{name:"status",control:x,render:({field:{value:u,onChange:c}})=>e.jsx(z,{checked:u,onChange:c})})]})]}),e.jsx(ne,{children:e.jsxs(C,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx($,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const me=({row:l,page:n,rowsPerPage:o,index:t,onClickOpenDialogEdit:d,onClickOpenDialogDelete:s})=>(f.useState(null),e.jsxs(P,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(h,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:n*o+t}),e.jsx(h,{className:"border-r border-slate-300",align:"left",children:l.hinhthuckhen}),e.jsx(h,{className:"border-r border-slate-300",align:"left",children:l.thutu}),e.jsx(h,{className:"border-r border-slate-300",align:"left",children:l.status===!0?e.jsx(C,{color:"success",children:"Đang sử dụng"}):e.jsx(C,{color:"warning",children:"Không sử dụng"})}),e.jsxs(h,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[e.jsx(C,{variant:"contained",color:"info",size:"small",onClick:()=>d(l),children:e.jsx(ue,{style:{fontSize:"20px"}})}),e.jsx(C,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>s(l._id),children:e.jsx(Y,{style:{fontSize:"20px"}})})]})]},l._id));function q(l){const n=Q(),{count:o,page:t,rowsPerPage:d,onPageChange:s}=l,x=a=>{s(a,0)},b=a=>{s(a,t-1)},p=a=>{s(a,t+1)},k=a=>{s(a,Math.max(0,Math.ceil(o/d)-1))};return e.jsxs(E,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(y,{onClick:x,disabled:t===0,"aria-label":"first page",children:n.direction==="rtl"?e.jsx(w,{}):e.jsx(O,{})}),e.jsx(y,{onClick:b,disabled:t===0,"aria-label":"previous page",children:n.direction==="rtl"?e.jsx(B,{}):e.jsx(_,{})}),e.jsx(y,{onClick:p,disabled:t>=Math.ceil(o/d)-1,"aria-label":"next page",children:n.direction==="rtl"?e.jsx(_,{}):e.jsx(B,{})}),e.jsx(y,{onClick:k,disabled:t>=Math.ceil(o/d)-1,"aria-label":"last page",children:n.direction==="rtl"?e.jsx(O,{}):e.jsx(w,{})})]})}q.propTypes={count:v.number.isRequired,onPageChange:v.func.isRequired,page:v.number.isRequired,rowsPerPage:v.number.isRequired};function fe({list:l,onClickOpenDialogEdit:n,onClickOpenDialogDelete:o}){const[t,d]=f.useState(0),[s,x]=f.useState(10),b=t>0?Math.max(0,(1+t)*s-l.length):0,p=(a,i)=>{d(i)},k=a=>{x(parseInt(a.target.value,10)),d(0)};return e.jsxs(e.Fragment,{children:[e.jsx(oe,{component:re,children:e.jsxs(ie,{"aria-label":"custom pagination table",children:[e.jsx(de,{children:e.jsxs(P,{children:[e.jsx(h,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(h,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Hình thức khen thưởng"}),e.jsx(h,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Thứ tự"}),e.jsx(h,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(143 1 1)"},children:"Trạng thái sử dụng"}),e.jsx(h,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(ce,{children:[(s>0?l.slice(t*s,t*s+s):l).map((a,i)=>e.jsx(me,{row:a,page:t,rowsPerPage:s,index:i+1,onClickOpenDialogEdit:n,onClickOpenDialogDelete:o},a._id)),b>0&&e.jsx(P,{style:{height:53*b},children:e.jsx(h,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(he,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:l.length,rowsPerPage:s,page:t,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:p,onRowsPerPageChange:k,ActionsComponent:q,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:i,to:u,count:c}){return`hiển thị ${i} đến ${u} bản ghi trong tổng số ${c!==-1?c:`more than ${u}`} bản ghi`}})})]})}const Ee=()=>{let l=T(r=>r.authReducer.vaitro_theodoithidua);const n=G();if(l!=="Quản trị hệ thống")return j.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(J,{to:"/login",replace:!0});const[o,t]=f.useState([]),[d,s]=U(),[x,b]=f.useState({status:!1,item:null}),p=()=>{b({...x,status:!1})},k=r=>{b({item:r,status:!0})},[a,i]=f.useState({status:!1,id_Delete:null}),u=r=>{i({status:!0,id_Delete:r})},c=()=>{i({...a,status:!1})},V=()=>{i({...a,status:!1})},{register:D,handleSubmit:F,control:M,resetField:S,setValue:W,watch:be,formState:{errors:je}}=H({defaultValues:{hinhthuckhen:"",thutu:1,status:!0}});f.useEffect(()=>{(async()=>{try{s(!0);let g=await N.getHinhthuckhens();t(g.data),s(!1)}catch(g){g.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(n("/login"),s(!1),j.error(g.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}))}})()},[]);const A=async r=>{let g={...r};s(!0);try{let m=await N.addHinhthuckhen(g);t(m.data.khois),s(!1),S("hinhthuckhen"),W("thutu",Number(r.thutu)+1),S("status"),j.success(m.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(m){j.error(m.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},K=async r=>{let g={...r};s(!0);try{let m=await N.editHinhthuckhen(g);t(m.data.khois),s(!1),j.success(m.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(m){j.error(m.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},L=async()=>{s(!0);try{let r=await N.deleteHinhthuckhen(a.id_Delete);t(r.data.khois),s(!1),i({...a,status:!1}),j.success(r.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(r){i({...a,status:!1}),j.error(r.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}};return T(r=>r.authReducer.roles_theodoithidua),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Quản lý hình thức khen thưởng"})}),e.jsxs("form",{className:"mt-2 px-6 py-4 shadow-gray-400 shadow-md",onSubmit:F(A),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Hình thức khen thưởng: "]}),e.jsx("input",{...D("hinhthuckhen",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...D("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái sử dụng:"}),e.jsx(R,{name:"status",control:M,render:({field:{value:r,onChange:g}})=>e.jsx(z,{checked:r,onChange:g})})]})]}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(C,{type:"submit",color:"primary",variant:"contained",children:[e.jsx($,{})," Thêm mới"]})})]}),e.jsx("div",{className:"mt-6 px-2 shadow-black shadow-sm",children:e.jsx(fe,{list:o,onClickOpenDialogDelete:u,onClickOpenDialogEdit:k})}),e.jsx(pe,{open:x.status,item:x.item,onCloseDialogEdit:p,onSubmit:K}),e.jsx(le,{open:a.status,onCloseDialogDelete:V,onConfirmDelete:L,onCancelDelete:c})]})};export{Ee as default};
