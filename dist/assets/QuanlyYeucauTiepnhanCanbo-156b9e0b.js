import{r,d as A,j as e,c as q,u as Q,Q as P,N as Y,e as G}from"./index-469ebc4a.js";import{T as D,a as h,P as w,b as F,c as W,d as X,e as J,f as K,g as L,h as z,i as E,j as H}from"./LastPage-511a91a0.js";import"./dayjs.min-e05fe7c1.js";import{P as U,B as Z,I as O}from"./MenuItem-22e0308b.js";import{c as R}from"./canboApi-a16ae5b6.js";import{d as ee}from"./doiApi-c5b61e58.js";import{S as ae}from"./react-select.esm-ea0f231f.js";import"./index.esm-a80e06b2.js";import{B as $}from"./Button-e3d685a6.js";import"./createSvgIcon-e7baeffd.js";import"./ButtonBase-ea83d2d9.js";import"./memoize-one.esm-c82963f8.js";const ne=({row:t,onClickOpenDialogEdit:p,onClickOpenDialogDelete:k,page:s,rowsPerPage:o,index:x,onChangeCheckBox:u,recevices:f})=>{const[g,m]=r.useState(!1);r.useState(null),A(b=>b.authReducer.roles_theodoithidua),r.useEffect(()=>{if(t._id){let b=f.findIndex(y=>y.value.toString()===t._id.toString());if(b===-1)return;m(f[b].isChecked)}},[f]);const d=b=>{const{value:y,checked:j}=b.target;u({value:y,checked:j})};return e.jsxs(D,{children:[e.jsx(h,{className:"border-r border-slate-300",align:"left",children:e.jsx("input",{className:"w-4 h-4",type:"checkbox",onChange:d,checked:g,value:t._id})}),e.jsx(h,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:s*o+x}),e.jsx(h,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:t.hoten}),e.jsx(h,{className:"border-r border-slate-300",align:"left",children:t.chucvu[0].chucvu}),e.jsx(h,{className:"border-r border-slate-300",align:"left",children:e.jsx("p",{className:"truncate",children:t.donvi.tenhienthi})}),e.jsx(h,{className:"border-r border-slate-300",align:"left",children:t.yeucauChuyencongtac.ghichu})]},t._id)};function I(t){const p=q(),{count:k,page:s,rowsPerPage:o,onPageChange:x}=t,u=d=>{x(d,0)},f=d=>{x(d,s-1)},g=d=>{x(d,s+1)},m=d=>{x(d,Math.max(0,Math.ceil(k/o)-1))};return e.jsxs(Z,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(O,{onClick:u,disabled:s===0,"aria-label":"first page",children:p.direction==="rtl"?e.jsx(L,{}):e.jsx(z,{})}),e.jsx(O,{onClick:f,disabled:s===0,"aria-label":"previous page",children:p.direction==="rtl"?e.jsx(E,{}):e.jsx(H,{})}),e.jsx(O,{onClick:g,disabled:s>=Math.ceil(k/o)-1,"aria-label":"next page",children:p.direction==="rtl"?e.jsx(H,{}):e.jsx(E,{})}),e.jsx(O,{onClick:m,disabled:s>=Math.ceil(k/o)-1,"aria-label":"last page",children:p.direction==="rtl"?e.jsx(z,{}):e.jsx(L,{})})]})}I.propTypes={count:w.number.isRequired,onPageChange:w.func.isRequired,page:w.number.isRequired,rowsPerPage:w.number.isRequired};function te({list:t,onClickOpenDialogDelete:p,onClickOpenDialogEdit:k,onChangeCheckList:s}){const[o,x]=r.useState(0),[u,f]=r.useState(10),[g,m]=r.useState([]),d=o>0?Math.max(0,(1+o)*u-t.length):0,b=(l,c)=>{x(c)},y=l=>{f(parseInt(l.target.value,10)),x(0)},[j,_]=r.useState([]);r.useEffect(()=>{_(t);let l=t.map(c=>({value:c._id,isChecked:!1}));m(l)},[t]);const N=l=>{const{name:c,value:v,checked:a}=l.target;let n=[...j],i=[...g];n=n.map(C=>C._id);for(let C of n){let V=i.findIndex(M=>M.value.toString()===C.toString());i[V].isChecked=a}m(i),s(i)},T=l=>{let{value:c,checked:v}=l,a=[...g],n=a.findIndex(i=>i.value===c);a[n].isChecked=v,m(a),s(a)},[S,B]=r.useState(!1);return r.useEffect(()=>{let l=[...j],c=[...g];l=l.map(a=>a._id);let v=0;for(let a of l){let n=c.findIndex(i=>i.value.toString()===a.toString());if(n===-1)return;c[n].isChecked===!0&&(v+=1)}l.length===v?B(!0):B(!1)},[j,T]),e.jsxs(e.Fragment,{children:[e.jsx(F,{component:U,style:{overflowX:"scroll"},children:e.jsxs(W,{"aria-label":"custom pagination table",children:[e.jsx(X,{children:e.jsxs(D,{children:[e.jsx(h,{align:"left",style:{fontSize:"14px"},className:"border-r border-slate-300",children:e.jsx("input",{type:"checkbox",name:"all",value:"",onChange:N,checked:S,className:"w-4 h-4"})}),e.jsx(h,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(h,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Họ tên"}),e.jsx(h,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Chức vụ"}),e.jsx(h,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Đơn vị chuyển đi"}),e.jsx(h,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Ghi chú của đơn vị chuyển"})]})}),e.jsxs(J,{children:[(u>0?t.slice(o*u,o*u+u):t).map((l,c)=>e.jsx(ne,{row:l,page:o,rowsPerPage:u,index:c+1,onClickOpenDialogEdit:k,onClickOpenDialogDelete:p,onChangeCheckBox:T,recevices:g},l._id)),d>0&&e.jsx(D,{style:{height:53*d},children:e.jsx(h,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(K,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:t.length,rowsPerPage:u,page:o,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:b,onRowsPerPageChange:y,ActionsComponent:I,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:c,to:v,count:a}){return`hiển thị ${c} đến ${v} bản ghi trong tổng số ${a!==-1?a:`more than ${v}`} bản ghi`}})})]})}const xe=()=>{let t=A(a=>a.authReducer.vaitro_theodoithidua);const p=Q();if(t!=="Quản trị thông thường")return P.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(Y,{to:"/login",replace:!0});const[k,s,o,x,u]=G(),[f,g]=r.useState([]),[m,d]=r.useState([]),[b,y]=r.useState([]),[j,_]=r.useState(""),[N,T]=r.useState(""),[S,B]=r.useState("");r.useEffect(()=>{(async()=>{try{let n=await R.fetchCanboYeucauTiepnhan(),i=await ee.getDois({tendoi:"",donvi:""});y(i.data.map(C=>({label:C.tendoi,value:C._id}))),g(n.data)}catch(n){console.log(n.message)}})()},[]);const l=a=>{d(a)},c=async()=>{let a=[...m];if(a=a.filter(n=>n.isChecked===!0).map(n=>n.value),a.length===0){alert("Vui lòng tích chọn cán bộ, chiến sĩ được tiếp nhận và chọn đội, tổ công tác");return}if(j===""){alert("Vui lòng chọn đội, tổ công tác sau khi tiếp nhận cán bộ, chiến sĩ");return}if(S===""){alert("Vui lòng chọn ngày bắt đầu công tác tại đơn vị");return}s(!0);try{let n=await R.dongyYeucauTiepnhan({array:a,donvi:j,ghichu:N,ngayvedonvi:S});o();let i=[...f];i=i.filter(C=>a.includes(C._id)===!1),g(i),s(!1),P.success(n.data.message,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"})}catch(n){n.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(p("/login"),s(!1),P.error(n.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"})),P.error(n.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),s(!1)}},v=async()=>{let a=[...m];if(a=a.filter(n=>n.isChecked===!0).map(n=>n.value),a.length===0){alert("Vui lòng tích chọn cán bộ, chiến sĩ được tiếp nhận và chọn đội, tổ công tác");return}s(!0);try{let n=await R.tuchoiYeucauTiepnhan({array:a,ghichu:N});o();let i=[...f];i=i.filter(C=>a.includes(C._id)===!1),g(i),s(!1)}catch(n){n.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(p("/login"),s(!1),P.error(n.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"})),P.error(n.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),s(!1)}};return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Quản lý yêu cầu tiếp nhận cán bộ từ đơn vị khác chuyển đến"})}),e.jsxs("div",{className:"flex items-center space-x-2 justify-end my-4",children:[e.jsx($,{variant:"contained",color:"success",size:"small",onClick:()=>c(),children:"Tiếp nhận cán bộ"}),e.jsx($,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>v(),children:"Từ chối yêu cầu"})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2 flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Ghi chú đính kèm: "}),e.jsx("input",{onChange:a=>T(a.target.value),value:N,type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-300\r
                   focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"shadow-sm shadow-gray-500 rounded-md py-2",children:[e.jsx("h5",{className:"italic px-2 py-3 text-red-600",children:'Các trường thông tin yêu cầu trước khi thực hiện thao tác "Tiếp nhận cán bộ"'}),e.jsx("div",{children:e.jsxs("div",{className:"flex-col flex flex-1 md:basis-1/2 px-1",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Vui lòng chọn đội nghiệp vụ, tổ công tác khi tiếp nhận cán bộ, chiến sĩ:"]}),e.jsx(ae,{options:b,className:"basic-multi-select my-4 rounded-md",classNamePrefix:"select",placeholder:"Chọn đội nghiệp vụ, tổ công tác cho cán bộ chiến sĩ",required:!0,onChange:a=>_(a.value)})]})}),e.jsxs("div",{className:"flex-col flex md:basis-1/2 flex-1 px-1",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Ngày nhận công tác tại đơn vị: "]}),e.jsx("input",{onChange:a=>B(a.target.value),value:S,type:"date",className:`outline-none my-4 border rounded-md p-2 border-neutral-300\r
                   focus:border-blue-500 focus:border-2`})]})]}),e.jsx("div",{className:"mt-6 mx-0 shadow-md shadow-gray-500 rounded-md",children:e.jsx(te,{list:f,onClickOpenDialogEdit:()=>{},onClickOpenDialogDelete:()=>{},onChangeCheckList:l})})]})};export{xe as default};
