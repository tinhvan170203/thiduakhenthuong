import{r,j as e,c as $,d as T,u as O,Q as k,N as Y,e as L}from"./index-469ebc4a.js";import{d as A}from"./Search-9d8f7eda.js";import"./index.esm-a80e06b2.js";import{S}from"./react-select.esm-ea0f231f.js";import{c as E}from"./canboApi-a16ae5b6.js";import{t as F}from"./thongkeApi-7ce5f50b.js";import{T as y,a as x,P as j,b as H,c as I,d as z,e as Q,f as W,g as w,h as R,i as B,j as q}from"./LastPage-511a91a0.js";import{P as K,B as V,I as v}from"./MenuItem-22e0308b.js";import{B as G}from"./Button-e3d685a6.js";import"./createSvgIcon-e7baeffd.js";import"./ButtonBase-ea83d2d9.js";import"./memoize-one.esm-c82963f8.js";const J=({row:o,page:t,rowsPerPage:i,index:a})=>(r.useState(null),e.jsxs(y,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(x,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:t*i+a}),e.jsx(x,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:o.donvi})]},o._id));function D(o){const t=$(),{count:i,page:a,rowsPerPage:g,onPageChange:c}=o,u=n=>{c(n,0)},m=n=>{c(n,a-1)},l=n=>{c(n,a+1)},h=n=>{c(n,Math.max(0,Math.ceil(i/g)-1))};return e.jsxs(V,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(v,{onClick:u,disabled:a===0,"aria-label":"first page",children:t.direction==="rtl"?e.jsx(w,{}):e.jsx(R,{})}),e.jsx(v,{onClick:m,disabled:a===0,"aria-label":"previous page",children:t.direction==="rtl"?e.jsx(B,{}):e.jsx(q,{})}),e.jsx(v,{onClick:l,disabled:a>=Math.ceil(i/g)-1,"aria-label":"next page",children:t.direction==="rtl"?e.jsx(q,{}):e.jsx(B,{})}),e.jsx(v,{onClick:h,disabled:a>=Math.ceil(i/g)-1,"aria-label":"last page",children:t.direction==="rtl"?e.jsx(R,{}):e.jsx(w,{})})]})}D.propTypes={count:j.number.isRequired,onPageChange:j.func.isRequired,page:j.number.isRequired,rowsPerPage:j.number.isRequired};function U({list:o}){const[t,i]=r.useState(0),[a,g]=r.useState(10),c=t>0?Math.max(0,(1+t)*a-o.length):0,u=(l,h)=>{i(h)},m=l=>{g(parseInt(l.target.value,10)),i(0)};return e.jsxs(e.Fragment,{children:[e.jsx(H,{component:K,children:e.jsxs(I,{"aria-label":"custom pagination table",children:[e.jsx(z,{children:e.jsxs(y,{children:[e.jsx(x,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(x,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Tên đơn vị"})]})}),e.jsxs(Q,{children:[(a>0?o.slice(t*a,t*a+a):o).map((l,h)=>e.jsx(J,{row:l,page:t,rowsPerPage:a,index:h+1},l._id)),c>0&&e.jsx(y,{style:{height:53*c},children:e.jsx(x,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(W,{rowsPerPageOptions:[10,25,50,100,200],count:o.length,rowsPerPage:a,page:t,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:u,onRowsPerPageChange:m,ActionsComponent:D,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:h,to:n,count:b}){return`hiển thị ${h} đến ${n} bản ghi trong tổng số ${b!==-1?b:`more than ${n}`} bản ghi`}})})]})}const ue=()=>{let o=T(s=>s.authReducer.vaitro_theodoithidua);const t=O();if(o!=="Quản trị hệ thống")return k.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(Y,{to:"/login",replace:!0});const[i,a]=r.useState(1),[g,c]=r.useState(1),[u,m]=r.useState(1),[l,h]=r.useState(2022),[n,b]=r.useState([]),[X,P]=L(),[C,M]=r.useState([]),[N,Z]=r.useState("");r.useEffect(()=>{(async()=>{try{let d=await E.fetchYearMonth();m(d.data.month),a(d.data.month),h(d.data.year),c(d.data.year);let f=[];for(let p=d.data.year;p>=2020;p--)f.push({label:p,value:p});b(f)}catch(d){d.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(t("/login"),k.error(d.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(d.message)}})()},[]);const _=async()=>{try{P(!0);let s=await F.fetchReportChuaSaveThiduathang({month:u,year:l});M(s.data),a(u),c(l),P(!1)}catch(s){console.log(s.message)}};return r.useEffect(()=>{const s=setTimeout(()=>{let f=[...doanviens].filter(p=>p.hoten.toLowerCase().includes(N.toLowerCase()));setDoanviensDisplay(f)},500);return()=>clearTimeout(s)},[N]),T(s=>s.authReducer.roles_theodoithidua),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Thống kê đơn vị chưa cập nhật kết quả thi đua tháng"})}),e.jsxs("div",{className:"space-x-2 flex justify-center shadow-gray-400 shadow-md p-4 rounded-sm",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/6",children:[e.jsx("label",{className:"font-semibold",children:"Tháng:"}),e.jsx(S,{value:{label:u,value:u},required:!0,name:"thang",options:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12}],className:"basic-multi-select my-4",classNamePrefix:"select",onChange:s=>m(s.value)})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/6",children:[e.jsx("label",{className:"font-semibold",children:"Năm:"}),e.jsx(S,{value:{label:l,value:l},required:!0,name:"nam",options:n,className:"basic-multi-select my-4",classNamePrefix:"select",onChange:s=>h(s.value)})]}),e.jsx("div",{className:"flex-col flex md:basis-1/6",children:e.jsxs(G,{onClick:()=>_(),color:"primary",variant:"contained",children:[e.jsx(A,{})," Thống kê danh sách"]})})]}),e.jsxs("div",{className:"mt-4 shadow-md shadow-gray-400",children:[e.jsx("p",{className:"text-center text-lg font-semibold",children:"Danh sách các đơn vị chưa cập nhật kết quả thi đua tháng"}),e.jsxs("p",{className:"text-center italic",children:["(Tháng ",i," Năm ",g,")"]}),e.jsxs("div",{className:"mt-8 px-2",children:[e.jsxs("p",{className:"text-end my-2 x-2",children:["Tổng số: ",e.jsx("span",{className:"text-red-600 font-bold text-2xl",children:C.length})," đơn vị chưa cập nhật kết quả thi đua tháng"]}),e.jsx("div",{className:"",children:e.jsx(U,{list:C})})]})]})]})};export{ue as default};
