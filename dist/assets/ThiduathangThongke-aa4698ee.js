import{j as e,r as a,u as ce,e as ie,d as de,Q as he}from"./index-469ebc4a.js";import"./index.esm-a80e06b2.js";import{u as ue,C as me}from"./index.esm-e24acc70.js";import{C as ge,d as xe}from"./FileDownload-8fac1ea7.js";import{S as x}from"./react-select.esm-ea0f231f.js";import{c as pe}from"./canboApi-a16ae5b6.js";import"./dayjs.min-e05fe7c1.js";import{t as w}from"./thongkeApi-7ce5f50b.js";import{T as be,a as fe}from"./TableBangthiduathang-516e6873.js";import{C as ye,b as ve,L as je,B as Te,c as _e,p as Se,a as Ce,d as Ne}from"./index-2d5c9321.js";import{d as we}from"./BarChart-aae44862.js";import{R as h}from"./RectangleChart-a9fb17bf.js";import{B as k}from"./Button-e3d685a6.js";import"./Link-3fd13359.js";import"./LastPage-511a91a0.js";import"./createSvgIcon-e7baeffd.js";import"./ButtonBase-ea83d2d9.js";import"./MenuItem-22e0308b.js";import"./memoize-one.esm-c82963f8.js";import"./Flag-f42070f3.js";import"./Tooltip-5660f822.js";import"./index-bfd39377.js";ye.register(ve,je,Te,_e,Se,Ce);const ke=["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],Be=({text:p,dataRed:u,dataBlue:b,dataYellow:m,dataNotValue:n})=>e.jsx(Ne,{options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:p}}},data:{labels:ke,datasets:[{label:"Cờ đỏ",data:u,backgroundColor:"rgba(255, 0, 0, 1)"},{label:"Cờ xanh",data:b,backgroundColor:"rgba(0, 82, 255, 1)"},{label:"Cờ vàng",data:m,backgroundColor:"rgba(230, 228, 22, 1)"},{label:"Chưa có dữ liệu",data:n,backgroundColor:"rgba(0, 224, 151, 0.8)"}]},width:1400,height:500});let De=[{label:"STT",key:"stt"},{label:"Họ tên",key:"hoten"},{label:"Đơn vị đang công tác",key:"donvidangcongtac"},{label:"Số lượt cờ xanh",key:"blue"},{label:"Số lượt cờ vàng",key:"yellow"}];const lt=()=>{const[p,u]=a.useState(""),[b,m]=a.useState("");a.useState([]);const[n,B]=a.useState({label:"",value:""}),[D,L]=a.useState(null),[Y,R]=a.useState(null),[E,$]=a.useState(null),[V,q]=a.useState(null),[F,O]=a.useState([]),[P,A]=a.useState([]),[r,f]=a.useState(0),[y,v]=a.useState(""),[H,M]=a.useState([]),[z,Q]=a.useState([]),[c,j]=a.useState(""),[X,T]=a.useState([]),G=ce(),[I,J]=a.useState([]),[K,U]=a.useState([]),[W,Z]=a.useState([]),[ee,te]=a.useState([]),[ae,se]=a.useState([]),[le,oe]=a.useState([]),[g,_]=a.useState({label:"Tất cả",value:""}),[Le,S]=ie(),{register:Ye,handleSubmit:Re,control:ne,resetField:Ee,setValue:C,watch:i,formState:{errors:$e}}=ue({defaultValues:{donvi:{label:"Tất cả",value:""},tungay:"",denngay:"",hoten:""}}),N=de(t=>t.authReducer.vaitro_theodoithidua);a.useEffect(()=>{(async()=>{try{let s=await pe.fetchYearMonth(),l=await w.getDonviDois({vaitro:N});J(l.data.data_donvi),C("tungay",s.data.year+"-01-01"),C("denngay",s.data.year+`-${("0"+s.data.month).slice(-2)}-15`),f(s.data.year),v(s.data.year);let o=[];for(let d=s.data.year;d>=2022;d--)o.push({label:d,value:d});M(o),u(s.data.year+"-01-01"),m(s.data.year+`-${("0"+s.data.month).slice(-2)}-15`)}catch(s){s.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(G("/login"),he.error(s.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(s.message)}})()},[]),a.useEffect(()=>{let t=[...z];if(t.length>0){const s=setTimeout(()=>{let l=t.filter(o=>o.hoten.toLowerCase().includes(c.toLowerCase())&&o.id_donvidangcongtac.includes(g.value));T(l)},500);return()=>clearTimeout(s)}},[c,g]);const re=async()=>{S(!0);try{v(r),B(i("donvi"));let t=await w.getBangThiduathangsDangCongtac({vaitro:N,nam:r,donvi:i("donvi").value});U(t.data.data_thidua_red_month_of_year),Z(t.data.data_thidua_blue_month_of_year),te(t.data.data_thidua_yellow_month_of_year),se(t.data.data_thidua_not_value_month_of_year),L(t.data.totalCanbo),R(t.data.data_not_red.length),$(t.data.total_flag_blue),q(t.data.total_flag_yellow),O(t.data.data_not_red),oe([{label:"Tất cả",value:""}].concat(t.data.list_doi_option)),j(""),_({label:"Tất cả",value:""});let s=t.data.data.filter(l=>l.hoten.toLowerCase().includes(c.toLowerCase()));Q(t.data.data),T(s),A(t.data.data_not_red.map((l,o)=>({stt:o+1,hoten:l.hoten,donvidangcongtac:l.donvidangcongtac,blue:l.blue,yellow:l.yellow}))),S(!1)}catch(t){console.log(t)}};return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Thống kê, theo dõi kết quả thi đua tháng của cán bộ, chiến sĩ công tác"})}),e.jsxs("div",{className:"my-2 mt-4 flex justify-center shadow-gray-400 shadow-md p-4 rounded-sm",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex px-1",children:[e.jsx("label",{className:"font-semibold",children:"Năm: "}),e.jsx(x,{value:{label:r,value:r},required:!0,name:"nam",options:H,className:"basic-multi-select my-4",classNamePrefix:"select",onChange:t=>f(t.value)})]}),e.jsxs("div",{className:"flex-col md:basis-1/3 flex px-1",children:[e.jsx("label",{className:"font-semibold",children:"Đơn vị: "}),e.jsx(me,{control:ne,name:"donvi",render:({field:t})=>e.jsx(x,{options:I,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Tất cả",...t})})]}),e.jsx("div",{className:"flex-col px-1 flex items-end justify-center",children:e.jsxs(k,{variant:"contained",onClick:()=>re(),style:{width:"200px"},color:"primary",children:[e.jsx(we,{})," Thống kê dữ liệu"]})})]}),e.jsxs("div",{className:"flex mb-8 mt-12 shadow-lg shadow-slate-300 py-8",children:[e.jsx(h,{text:"Tổng số cán bộ, chiến sĩ",number:D,color:"bg-red-600"}),e.jsx(h,{text:"Tổng số cán bộ, chiến sĩ thi đua cờ xanh, cờ vàng",number:Y,color:"bg-cyan-600"}),e.jsx(h,{text:"Tổng số lượt cờ xanh",number:E,color:"bg-blue-600"}),e.jsx(h,{text:"Tổng số lượt cờ vàng",number:V,color:"bg-yellow-600"})]}),e.jsx("div",{className:"items-center flex justify-center my-2 mt-4 shadow-gray-400 shadow-md p-4 rounded-lg",children:e.jsx(Be,{text:`Biểu đồ kết quả thi đua tháng trong năm ${y} ${n.label}`,dataRed:K,dataBlue:W,dataYellow:ee,dataNotValue:ae})}),e.jsxs("div",{className:"px-4 mt-8",children:[e.jsxs("p",{className:"text-center text-lg mt-8 font-semibold",children:["Bảng theo dõi kết quả thi đua tháng của cán bộ, chiến sĩ công tác năm ",y]}),e.jsxs("h3",{className:"text-center text-lg text-black",children:[" ",n==null?void 0:n.label]}),e.jsxs("div",{className:"flex space-x-2 md:flex-row justify-end items-center",children:[e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx("input",{value:c,placeholder:"Tìm kiếm cán bộ",name:"search",onChange:t=>j(t.target.value),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-300\r
                    focus:border-blue-500 focus:border-2`})}),e.jsx("div",{className:"flex-col md:basis-1/3 flex px-1",children:e.jsx(x,{value:g,options:le,className:"basic-multi-select my-3 p-1",classNamePrefix:"select",placeholder:"Đơn vị công tác",onChange:t=>_(t)})})]})]}),e.jsx("div",{children:e.jsx(be,{list:X})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-center text-lg my-8 font-semibold",children:"Danh sách cán bộ, chiến sĩ xếp loại thi đua tháng cờ xanh, cờ vàng"}),e.jsx("div",{className:"mt-4 text-end mb-2 md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsx(k,{variant:"contained",color:"success",size:"small",children:e.jsxs(ge,{data:P,headers:De,filename:`danhsachcoxanhcovang_${i("tungay")}_${i("denngay")}`,children:[e.jsx(xe,{}),e.jsx("span",{className:"text-sm ml-1 text-white",children:"Xuất file excel"})]})})}),e.jsx(fe,{list:F})]})]})};export{lt as default};
