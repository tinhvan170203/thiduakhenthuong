import{r as g,j as e,s as K,d as S,c as G,u as J,Q as b,N as U,e as X,f as C}from"./index-469ebc4a.js";import"./index.esm-a80e06b2.js";import{u as $}from"./index.esm-e24acc70.js";import{d as z}from"./Add-c692c54c.js";import{D as Y}from"./DialogDelete-28d67f98.js";import{a as Z,d as ee}from"./AutoAwesomeMotion-01db5c5f.js";import{S as se,D as te,a as ae,d as re,b as ne}from"./Cancel-be6c3443.js";import{I as N,B as E,P as le}from"./MenuItem-22e0308b.js";import{D as oe}from"./DialogActions-425572d2.js";import{B as k}from"./Button-e3d685a6.js";import{T as w,a as u,P as v,b as ie,c as de,d as ce,e as ue,f as he,g as O,h as B,i as _,j as R}from"./LastPage-511a91a0.js";import{d as ge}from"./Edit-1cb268c9.js";import"./createSvgIcon-e7baeffd.js";import"./ButtonBase-ea83d2d9.js";const pe=g.forwardRef(function(a,i){return e.jsx(se,{direction:"up",ref:i,...a})}),me=K(N)({position:"absolute",right:"16px",top:"4px"});function xe({open:n,item:a,onCloseDialogEdit:i,onSubmit:t}){const{register:c,handleSubmit:s,control:m,resetField:x,setValue:p,watch:y,formState:{errors:l}}=$({defaultValues:{chucvu:"",thutu:1}});g.useState([]),g.useEffect(()=>{a&&(p("noidung",a.noidung,{shouldValidate:!0}),p("thutu",a.thutu,{shouldValidate:!0}),p("trangthai",a.status))},[a]);const d=async h=>{if(t){const f={...h,id_edit:a._id};await t(f),i()}};return e.jsx(e.Fragment,{children:e.jsxs(te,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(h,f)=>{f!=="backdropClick"&&i(h,f)},open:n,TransitionComponent:pe,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(ae,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"#03528f",margin:"0px"},children:[e.jsx(Z,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa nội dung ảnh nổi bật"}),e.jsx(me,{onClick:()=>i(),children:e.jsx(re,{style:{color:"white"}})})]}),e.jsx(ne,{children:e.jsx(E,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:s(d),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Nội dung ảnh: "]}),e.jsx("input",{...c("noidung",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...c("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"space-x-3 items-center flex md:basis-1/6 p-1",children:[e.jsxs("label",{className:"underline  font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Trạng thái sử dụng: "]}),e.jsx("input",{...c("trangthai"),type:"checkbox",autoComplete:"on",className:`outline-none my-4 border rounded-md p-2 w-6 h-6 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsx("img",{className:"w-[300px]",src:`/img/${a==null?void 0:a.url}`,alt:"img"}),e.jsx(oe,{children:e.jsxs(k,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx(z,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const fe=({row:n,page:a,rowsPerPage:i,index:t,onClickOpenDialogEdit:c,onClickOpenDialogDelete:s})=>(g.useState(null),S(m=>m.authReducer.roles_theodoithidua),e.jsxs(w,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(u,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a*i+t}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:e.jsx("img",{className:"w-[300px]",src:`/img/${n.url}`,alt:"img"})}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:n.noidung}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:n.thutu}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:n.status===!0?e.jsx("span",{className:"text-blue-600 font-semibold",children:"Hiển thị"}):e.jsx("span",{className:"text-red-600 font-semibold",children:"Không hiển thị"})}),e.jsxs(u,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[e.jsx(k,{variant:"contained",color:"info",size:"small",onClick:()=>c(n),children:e.jsx(ge,{style:{fontSize:"20px"}})}),e.jsx(k,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>s(n._id),children:e.jsx(ee,{style:{fontSize:"20px"}})})]})]},n._id));function H(n){const a=G(),{count:i,page:t,rowsPerPage:c,onPageChange:s}=n,m=l=>{s(l,0)},x=l=>{s(l,t-1)},p=l=>{s(l,t+1)},y=l=>{s(l,Math.max(0,Math.ceil(i/c)-1))};return e.jsxs(E,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(N,{onClick:m,disabled:t===0,"aria-label":"first page",children:a.direction==="rtl"?e.jsx(O,{}):e.jsx(B,{})}),e.jsx(N,{onClick:x,disabled:t===0,"aria-label":"previous page",children:a.direction==="rtl"?e.jsx(_,{}):e.jsx(R,{})}),e.jsx(N,{onClick:p,disabled:t>=Math.ceil(i/c)-1,"aria-label":"next page",children:a.direction==="rtl"?e.jsx(R,{}):e.jsx(_,{})}),e.jsx(N,{onClick:y,disabled:t>=Math.ceil(i/c)-1,"aria-label":"last page",children:a.direction==="rtl"?e.jsx(B,{}):e.jsx(O,{})})]})}H.propTypes={count:v.number.isRequired,onPageChange:v.func.isRequired,page:v.number.isRequired,rowsPerPage:v.number.isRequired};function be({list:n,onClickOpenDialogEdit:a,onClickOpenDialogDelete:i}){const[t,c]=g.useState(0),[s,m]=g.useState(10),x=t>0?Math.max(0,(1+t)*s-n.length):0,p=(l,d)=>{c(d)},y=l=>{m(parseInt(l.target.value,10)),c(0)};return e.jsxs(e.Fragment,{children:[e.jsx(ie,{component:le,children:e.jsxs(de,{"aria-label":"custom pagination table",children:[e.jsx(ce,{children:e.jsxs(w,{children:[e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Hình ảnh"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Nội dung"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Thứ tự"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Trạng thái"}),e.jsx(u,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(ue,{children:[(s>0?n.slice(t*s,t*s+s):n).map((l,d)=>e.jsx(fe,{row:l,page:t,rowsPerPage:s,index:d+1,onClickOpenDialogEdit:a,onClickOpenDialogDelete:i},l._id)),x>0&&e.jsx(w,{style:{height:53*x},children:e.jsx(u,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(he,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:n.length,rowsPerPage:s,page:t,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:p,onRowsPerPageChange:y,ActionsComponent:H,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:d,to:h,count:f}){return`hiển thị ${d} đến ${h} bản ghi trong tổng số ${f!==-1?f:`more than ${h}`} bản ghi`}})})]})}const Ee=()=>{let n=S(r=>r.authReducer.vaitro_theodoithidua);const a=J();if(n!=="Quản trị hệ thống")return b.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(U,{to:"/login",replace:!0});const[i,t]=g.useState([]),[c,s]=X(),m=g.useRef(),[x,p]=g.useState({status:!1,item:null}),y=()=>{p({...x,status:!1})},l=r=>{p({item:r,status:!0})},[d,h]=g.useState({status:!1,id_Delete:null}),f=r=>{h({status:!0,id_Delete:r})},I=()=>{h({...d,status:!1})},F=()=>{h({...d,status:!1})},{register:D,handleSubmit:q,control:je,resetField:T,watch:Ce,formState:{errors:ye}}=$({defaultValues:{noidung:"",thutu:1,trangthai:!0}}),[M,V]=g.useState(null),W=r=>{V(r.target.files[0])};g.useEffect(()=>{(async()=>{s(!0);try{let o=await C.getImg();t(o.data),setTimeout(()=>{s(!1)},400)}catch(o){o.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(a("/login"),s(!1),b.error(o.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),console.log(o.message)}})()},[]);const A=async r=>{const o=new FormData;o.append("file",M),o.append("noidung",r.noidung),o.append("thutu",r.thutu),o.append("status",r.trangthai),s(!0);try{let j=await C.saveImg(o),P=await C.getImg();t(P.data),m.current.value="",s(!1),T("noidung"),T("thutu"),b.success(j.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(j){b.error(j.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},L=async r=>{let o={...r};s(!0);try{let j=await C.editImg(o,o.id_edit),P=await C.getImg();t(P.data),s(!1),b.success(j.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(j){b.error(j.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},Q=async()=>{s(!0);try{let r=await C.deleteImg(d.id_Delete),o=await C.getImg();t(o.data),s(!1),h({...d,status:!1}),b.success(r.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(r){h({...d,status:!1}),b.error(r.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}};return S(r=>r.authReducer.roles_theodoithidua),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Quản lý thư viện ảnh trình chiếu các hoạt động nổi bật"})}),e.jsxs("form",{className:"mt-2 px-6 py-4 shadow-gray-400 shadow-md",onSubmit:q(A),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Nội dung ảnh: "]}),e.jsx("input",{...D("noidung",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...D("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsxs("div",{className:"space-x-3 items-center flex md:basis-1/6 p-1",children:[e.jsxs("label",{className:"underline  font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Trạng thái sử dụng: "]}),e.jsx("input",{...D("trangthai"),type:"checkbox",autoComplete:"on",className:`outline-none my-4 border rounded-md p-2 w-6 h-6 border-neutral-600\r
                  focus:border-blue-500 focus:border-2`})]}),e.jsx("div",{className:"my-2",children:e.jsx("input",{ref:m,required:!0,className:"mt-4",accept:".img, .png, .jpg,.jpeg",type:"file",onChange:r=>W(r)})}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(k,{type:"submit",color:"primary",variant:"contained",children:[e.jsx(z,{})," Thêm mới"]})})]}),e.jsxs("div",{className:"mt-6 shadow-black shadow-sm px-2",children:[e.jsx("h4",{className:"text-center font-semibold text-blue-600 py-4 uppercase",children:"Danh sách hình ảnh nổi bật trong Công an đơn vị"}),e.jsx(be,{list:i,onClickOpenDialogDelete:f,onClickOpenDialogEdit:l})]}),e.jsx(xe,{open:x.status,item:x.item,onCloseDialogEdit:y,onSubmit:L}),e.jsx(Y,{open:d.status,onCloseDialogDelete:F,onConfirmDelete:Q,onCancelDelete:I})]})};export{Ee as default};
