import{r as P,j as e,c as H,d as _,u as z,Q as g,e as $}from"./index-469ebc4a.js";import{u as M}from"./index.esm-e24acc70.js";import{d as A}from"./Add-c692c54c.js";import{c as C}from"./canboApi-a16ae5b6.js";import{P as m,b as F,c as L,d as q,T as y,a as l,e as V,f as W,g as N,h as B,i as S,j as T}from"./LastPage-511a91a0.js";import{d as Y}from"./dayjs.min-e05fe7c1.js";import{P as I,B as Q,I as b}from"./MenuItem-22e0308b.js";import{B as k}from"./Button-e3d685a6.js";import"./createSvgIcon-e7baeffd.js";import"./ButtonBase-ea83d2d9.js";function O(h){const i=H(),{count:u,page:a,rowsPerPage:o,onPageChange:t}=h,p=r=>{t(r,0)},f=r=>{t(r,a-1)},x=r=>{t(r,a+1)},n=r=>{t(r,Math.max(0,Math.ceil(u/o)-1))};return e.jsxs(Q,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(b,{onClick:p,disabled:a===0,"aria-label":"first page",children:i.direction==="rtl"?e.jsx(N,{}):e.jsx(B,{})}),e.jsx(b,{onClick:f,disabled:a===0,"aria-label":"previous page",children:i.direction==="rtl"?e.jsx(S,{}):e.jsx(T,{})}),e.jsx(b,{onClick:x,disabled:a>=Math.ceil(u/o)-1,"aria-label":"next page",children:i.direction==="rtl"?e.jsx(T,{}):e.jsx(S,{})}),e.jsx(b,{onClick:n,disabled:a>=Math.ceil(u/o)-1,"aria-label":"last page",children:i.direction==="rtl"?e.jsx(B,{}):e.jsx(N,{})})]})}O.propTypes={count:m.number.isRequired,onPageChange:m.func.isRequired,page:m.number.isRequired,rowsPerPage:m.number.isRequired};function E({list:h,onChangeStatus:i,onDelete:u}){const[a,o]=P.useState(0),[t,p]=P.useState(10);a>0&&Math.max(0,(1+a)*t-h.length);const f=(n,r)=>{o(r)},x=n=>{p(parseInt(n.target.value,10)),o(0)};return e.jsxs(e.Fragment,{children:[e.jsx(F,{component:I,children:e.jsxs(L,{"aria-label":"custom pagination table",children:[e.jsx(q,{children:e.jsxs(y,{children:[e.jsx(l,{align:"left",rowSpan:2,style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"#"}),e.jsx(l,{align:"left",rowSpan:2,style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(143 1 1)"},children:"Họ tên"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Ngày sinh"}),e.jsx(l,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Đơn vị thực hiện xóa"}),e.jsx(l,{align:"right",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(143 1 1)"},children:"Thao tác"})]})}),e.jsx(V,{children:(t>0?h.slice(a*t,a*t+t):h).map((n,r)=>e.jsxs(y,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(l,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a*t+r+1}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:e.jsx("span",{className:"font-bold",children:n.hoten})}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:Y(n.ngaysinh).format("DD/MM/YYYY")}),e.jsx(l,{className:"border-r border-slate-300",align:"left",children:e.jsx("p",{className:"truncate",children:n.donviBeforeDelete.tenhienthi})}),e.jsxs(l,{className:"border-r border-slate-300",align:"right",children:[e.jsx(k,{variant:"contained",color:"info",size:"small",onClick:()=>i(n._id),children:"Thay đổi trạng thái active"}),e.jsx(k,{variant:"contained",color:"info",size:"small",style:{marginLeft:"12px"},onClick:()=>u(n._id),children:"Xóa đoàn viên khỏi hệ thống vĩnh viễn"})]})]},n._id))})]})}),e.jsx("div",{children:e.jsx(W,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:h.length,rowsPerPage:t,page:a,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:f,onRowsPerPageChange:x,ActionsComponent:O,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:r,to:j,count:v}){return`hiển thị ${r} đến ${j} bản ghi trong tổng số ${v!==-1?v:`more than ${j}`} bản ghi`}})})]})}const re=()=>{let h=_(c=>c.authReducer.vaitro_theodoithidua);const i=z();if(h!=="Quản trị hệ thống")return g.error("Tài khoản không có truy cập trang này",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"light"}),e.jsx(Navigate,{to:"/login",replace:!0});const[u,a]=$(),[o,t]=P.useState([]),{register:p,handleSubmit:f,control:x,resetField:n,setValue:r,watch:j,formState:{errors:v}}=M({defaultValues:{hoten:""}}),D=async c=>{let s={...c};try{a(!0);let d=await C.fetchCanboStatusDelete(s);t(d.data),a(!1)}catch(d){d.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(i("/login"),a(!1),g.error(d.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),g.error(d.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),a(!1)}},w=async c=>{a(!0);try{await C.changeActive(c);let s=[...o];s=s.filter(d=>d._id.toString()!==c),t(s),a(!1),g.success("Thay đổi trạng thái thành công",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(s){s.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(i("/login"),a(!1),g.error(s.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})),g.error(s.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),a(!1)}},R=async c=>{a(!0);try{await C.deletePersonAdvaned(c);let s=[...o];s=s.filter(d=>d._id.toString()!==c),t(s),a(!1),g.success("Xóa đoàn viên khỏi hệ thống thành công",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(s){g.error(s.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),a(!1)}};return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-2",children:e.jsx("h4",{className:"uppercase font-bold text-blue-800 text-sm md:text-[18px]",children:"Quản lý danh sách cán bộ, chiến sĩ bị xóa bởi tài khoản người dùng (mức 1)"})}),e.jsx("form",{onSubmit:f(D),children:e.jsxs("div",{className:"flex mt-4 px-4 space-x-2 md:flex-row justify-end items-start",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1",children:[e.jsx("label",{className:"underline font-semibold",children:"Họ tên: "}),e.jsx("input",{...p("hoten"),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                    focus:border-blue-500 focus:border-2`})]}),e.jsx("div",{className:"flex-col flex md:basis-1/6",children:e.jsxs(k,{size:"small",type:"submit",color:"primary",variant:"contained",children:[e.jsx(A,{})," Lấy dữ liệu"]})})]})}),e.jsx("div",{className:"px-4","data-aos":"fade-left","data-aos-once":"true",children:e.jsx("div",{className:"mt-4",children:e.jsx(E,{list:o,onChangeStatus:w,onDelete:R})})})]})};export{re as default};
